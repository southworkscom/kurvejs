{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///dist/kurve.min.js","webpack:///webpack/bootstrap c30e60a2eaa9103718e9","webpack:///./src/index.ts","webpack:///./src/graph.ts","webpack:///./src/promises.ts","webpack:///./src/identity.ts"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","graph_1","identity_1","Graph","Identity","Scopes","__extends","d","b","__","constructor","hasOwnProperty","prototype","Object","create","promises_1","Util","rootUrl","General","OpenId","OfflineAccess","User","Read","ReadWrite","ReadBasicAll","ReadAll","ReadWriteAll","Contacts","Directory","AccessAsUserAll","Group","Mail","Send","Calendars","Files","ReadWriteAppFolder","ReadWriteSelected","Tasks","People","Notes","Create","ReadWriteCreatedByApp","DataModelWrapper","graph","_data","defineProperty","get","enumerable","configurable","DataModelListWrapper","_super","apply","arguments","ProfilePhotoDataModel","ProfilePhoto","UserDataModel","EventsEndpoint","events","callback","odataQuery","eventsForUser","userPrincipalName","eventsAsync","eventsForUserAsync","memberOf","Error","memberOfForUser","memberOfAsync","memberOfForUserAsync","messages","messagesForUser","messagesAsync","messagesForUserAsync","manager","managerForUser","managerAsync","managerForUserAsync","profilePhoto","profilePhotoForUser","profilePhotoAsync","profilePhotoForUserAsync","profilePhotoValue","profilePhotoValueForUser","profilePhotoValueAsync","profilePhotoValueForUserAsync","calendarView","calendarViewAsync","mailFolders","mailFoldersForUser","mailFoldersAsync","mailFoldersForUserAsync","Users","MessageDataModel","Message","Messages","EventDataModel","Event","Events","endpoint","Contact","GroupDataModel","Groups","MailFolderDataModel","MailFolder","MailFolders","AttachmentType","AttachmentDataModel","Attachment","getType","fileAttachment","itemAttachment","referenceAttachment","Attachments","identityInfo","req","accessToken","KurveIdentity","defaultResourceID","baseUrl","defaultAccessToken","identity","scopesForV2","scopes","getCurrentOauthVersion","OAuthVersion","v1","meAsync","Deferred","me","user","error","reject","resolve","promise","urlString","buildMeUrl","getUser","userAsync","userId","basicProfileOnly","buildUsersUrl","usersAsync","users","getUsers","groupAsync","groupId","group","buildGroupsUrl","getGroup","groupsAsync","groups","getGroups","getMessages","result","getMailFolders","getEvents","directReportsForUserAsync","directReportsForUser","getPhoto","getPhotoValue","messageAttachmentsForUserAsync","messageId","messageAttachmentsForUser","getMessageAttachments","messageAttachmentForUserAsync","attachmentId","messageAttachmentForUser","attachment","getMessageAttachment","getAsync","url","response","responseType","_this","xhr","XMLHttpRequest","onreadystatechange","readyState","status","responseText","generateError","open","addAccessTokenAndSend","addTokenError","statusText","text","other","errorGet","usersODATA","JSON","parse","errorODATA","resultsArray","value","map","o","nextLink","userODATA","setRequestHeader","send","getAccessTokenForScopes","token","getAccessToken","messagesODATA","odata","groupsODATA","ODATA","ODATAError","photo","attachmentsODATA","attachments","buildUrl","path","DispatchDeferred","closure","setTimeout","PromiseState","Client","_dispatcher","_successCB","_errorCB","defer","_dispatchCallback","arg","err","dispatcher","_stack","_state","Pending","Promise","then","successCB","errorCB","client","ResolutionInProgress","push","Resolved","_value","Rejected","_error","_resolve","type","pending","i","stackSize","length","splice","TypeError","_reject","_deferred","successCallback","errorCallback","fail","undefined","CachedToken","resource","expiry","Date","getTime","hasScopes","requiredScopes","every","requiredScope","some","actualScope","TokenCache","tokenStorage","cachedTokens","getAll","forEach","_a","cachedToken","isExpired","remove","add","getForResource","getForScopes","key","clear","IdToken","identitySettings","policy","clientId","tokenProcessorUrl","tokenProcessingUri","version","tokenCache","window","addEventListener","event","data","e","loginCallback","state","decodeIdToken","getTokenCallback","iframe","document","getElementById","parentNode","removeChild","checkForIdentityRedirect","s","start","location","href","indexOf","end","substring","parseQueryString","str","queryString","search","keyValPairs","params","replace","split","pairNum","idToken","decodedToken","base64Decode","lastIndexOf","decodedTokenJSON","expiryDate","parseInt","exp","FullToken","Token","Expiry","UPN","upn","TenantId","tid","FamilyName","family_name","GivenName","given_name","Name","name","PreferredUsername","preferred_username","expiration","refreshTimer","renewIdToken","decodeAccessToken","join","getIdToken","isLoggedIn","clearTimeout","login","getAccessTokenAsync","nonce","generateNonce","createElement","style","display","src","encodeURIComponent","toString","body","appendChild","getAccessTokenForScopesAsync","promptForConsent","v2","loginAsync","loginSettings","tenant","loginURL","loginNoWindowAsync","toUrl","loginNoWindow","redirected","redirectUri","logOut","encodeURI","encodedString","x","a","l","r","w","String","fromCharCode","L","A","charAt","chars","Math","floor","random"],"mappings":"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","file":"dist/kurve.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Kurve\"] = factory();\n\telse\n\t\troot[\"Kurve\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Kurve\"] = factory();\n\telse\n\t\troot[\"Kurve\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar graph_1 = __webpack_require__(1);\n\tvar identity_1 = __webpack_require__(3);\n\tmodule.exports = {\n\t    Graph: graph_1.Graph,\n\t    Identity: identity_1.Identity\n\t};\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar __extends = (this && this.__extends) || function (d, b) {\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    function __() { this.constructor = d; }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar promises_1 = __webpack_require__(2);\n\tvar identity_1 = __webpack_require__(3);\n\tvar Scopes;\n\t(function (Scopes) {\n\t    var Util = (function () {\n\t        function Util() {\n\t        }\n\t        Util.rootUrl = \"https://graph.microsoft.com/\";\n\t        return Util;\n\t    }());\n\t    var General = (function () {\n\t        function General() {\n\t        }\n\t        General.OpenId = \"openid\";\n\t        General.OfflineAccess = \"offline_access\";\n\t        return General;\n\t    }());\n\t    Scopes.General = General;\n\t    var User = (function () {\n\t        function User() {\n\t        }\n\t        User.Read = Util.rootUrl + \"User.Read\";\n\t        User.ReadWrite = Util.rootUrl + \"User.ReadWrite\";\n\t        User.ReadBasicAll = Util.rootUrl + \"User.ReadBasic.All\";\n\t        User.ReadAll = Util.rootUrl + \"User.Read.All\";\n\t        User.ReadWriteAll = Util.rootUrl + \"User.ReadWrite.All\";\n\t        return User;\n\t    }());\n\t    Scopes.User = User;\n\t    var Contacts = (function () {\n\t        function Contacts() {\n\t        }\n\t        Contacts.Read = Util.rootUrl + \"Contacts.Read\";\n\t        Contacts.ReadWrite = Util.rootUrl + \"Contacts.ReadWrite\";\n\t        return Contacts;\n\t    }());\n\t    Scopes.Contacts = Contacts;\n\t    var Directory = (function () {\n\t        function Directory() {\n\t        }\n\t        Directory.ReadAll = Util.rootUrl + \"Directory.Read.All\";\n\t        Directory.ReadWriteAll = Util.rootUrl + \"Directory.ReadWrite.All\";\n\t        Directory.AccessAsUserAll = Util.rootUrl + \"Directory.AccessAsUser.All\";\n\t        return Directory;\n\t    }());\n\t    Scopes.Directory = Directory;\n\t    var Group = (function () {\n\t        function Group() {\n\t        }\n\t        Group.ReadAll = Util.rootUrl + \"Group.Read.All\";\n\t        Group.ReadWriteAll = Util.rootUrl + \"Group.ReadWrite.All\";\n\t        Group.AccessAsUserAll = Util.rootUrl + \"Directory.AccessAsUser.All\";\n\t        return Group;\n\t    }());\n\t    Scopes.Group = Group;\n\t    var Mail = (function () {\n\t        function Mail() {\n\t        }\n\t        Mail.Read = Util.rootUrl + \"Mail.Read\";\n\t        Mail.ReadWrite = Util.rootUrl + \"Mail.ReadWrite\";\n\t        Mail.Send = Util.rootUrl + \"Mail.Send\";\n\t        return Mail;\n\t    }());\n\t    Scopes.Mail = Mail;\n\t    var Calendars = (function () {\n\t        function Calendars() {\n\t        }\n\t        Calendars.Read = Util.rootUrl + \"Calendars.Read\";\n\t        Calendars.ReadWrite = Util.rootUrl + \"Calendars.ReadWrite\";\n\t        return Calendars;\n\t    }());\n\t    Scopes.Calendars = Calendars;\n\t    var Files = (function () {\n\t        function Files() {\n\t        }\n\t        Files.Read = Util.rootUrl + \"Files.Read\";\n\t        Files.ReadAll = Util.rootUrl + \"Files.Read.All\";\n\t        Files.ReadWrite = Util.rootUrl + \"Files.ReadWrite\";\n\t        Files.ReadWriteAppFolder = Util.rootUrl + \"Files.ReadWrite.AppFolder\";\n\t        Files.ReadWriteSelected = Util.rootUrl + \"Files.ReadWrite.Selected\";\n\t        return Files;\n\t    }());\n\t    Scopes.Files = Files;\n\t    var Tasks = (function () {\n\t        function Tasks() {\n\t        }\n\t        Tasks.ReadWrite = Util.rootUrl + \"Tasks.ReadWrite\";\n\t        return Tasks;\n\t    }());\n\t    Scopes.Tasks = Tasks;\n\t    var People = (function () {\n\t        function People() {\n\t        }\n\t        People.Read = Util.rootUrl + \"People.Read\";\n\t        People.ReadWrite = Util.rootUrl + \"People.ReadWrite\";\n\t        return People;\n\t    }());\n\t    Scopes.People = People;\n\t    var Notes = (function () {\n\t        function Notes() {\n\t        }\n\t        Notes.Create = Util.rootUrl + \"Notes.Create\";\n\t        Notes.ReadWriteCreatedByApp = Util.rootUrl + \"Notes.ReadWrite.CreatedByApp\";\n\t        Notes.Read = Util.rootUrl + \"Notes.Read\";\n\t        Notes.ReadAll = Util.rootUrl + \"Notes.Read.All\";\n\t        Notes.ReadWriteAll = Util.rootUrl + \"Notes.ReadWrite.All\";\n\t        return Notes;\n\t    }());\n\t    Scopes.Notes = Notes;\n\t})(Scopes = exports.Scopes || (exports.Scopes = {}));\n\tvar DataModelWrapper = (function () {\n\t    function DataModelWrapper(graph, _data) {\n\t        this.graph = graph;\n\t        this._data = _data;\n\t    }\n\t    Object.defineProperty(DataModelWrapper.prototype, \"data\", {\n\t        get: function () { return this._data; },\n\t        enumerable: true,\n\t        configurable: true\n\t    });\n\t    return DataModelWrapper;\n\t}());\n\texports.DataModelWrapper = DataModelWrapper;\n\tvar DataModelListWrapper = (function (_super) {\n\t    __extends(DataModelListWrapper, _super);\n\t    function DataModelListWrapper() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    return DataModelListWrapper;\n\t}(DataModelWrapper));\n\texports.DataModelListWrapper = DataModelListWrapper;\n\tvar ProfilePhotoDataModel = (function () {\n\t    function ProfilePhotoDataModel() {\n\t    }\n\t    return ProfilePhotoDataModel;\n\t}());\n\texports.ProfilePhotoDataModel = ProfilePhotoDataModel;\n\tvar ProfilePhoto = (function (_super) {\n\t    __extends(ProfilePhoto, _super);\n\t    function ProfilePhoto() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    return ProfilePhoto;\n\t}(DataModelWrapper));\n\texports.ProfilePhoto = ProfilePhoto;\n\tvar UserDataModel = (function () {\n\t    function UserDataModel() {\n\t    }\n\t    return UserDataModel;\n\t}());\n\texports.UserDataModel = UserDataModel;\n\t(function (EventsEndpoint) {\n\t    EventsEndpoint[EventsEndpoint[\"events\"] = 0] = \"events\";\n\t    EventsEndpoint[EventsEndpoint[\"calendarView\"] = 1] = \"calendarView\";\n\t})(exports.EventsEndpoint || (exports.EventsEndpoint = {}));\n\tvar EventsEndpoint = exports.EventsEndpoint;\n\tvar User = (function (_super) {\n\t    __extends(User, _super);\n\t    function User() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    User.prototype.events = function (callback, odataQuery) {\n\t        this.graph.eventsForUser(this._data.userPrincipalName, EventsEndpoint.events, callback, odataQuery);\n\t    };\n\t    User.prototype.eventsAsync = function (odataQuery) {\n\t        return this.graph.eventsForUserAsync(this._data.userPrincipalName, EventsEndpoint.events, odataQuery);\n\t    };\n\t    User.prototype.memberOf = function (callback, Error, odataQuery) {\n\t        this.graph.memberOfForUser(this._data.userPrincipalName, callback, odataQuery);\n\t    };\n\t    User.prototype.memberOfAsync = function (odataQuery) {\n\t        return this.graph.memberOfForUserAsync(this._data.userPrincipalName, odataQuery);\n\t    };\n\t    User.prototype.messages = function (callback, odataQuery) {\n\t        this.graph.messagesForUser(this._data.userPrincipalName, callback, odataQuery);\n\t    };\n\t    User.prototype.messagesAsync = function (odataQuery) {\n\t        return this.graph.messagesForUserAsync(this._data.userPrincipalName, odataQuery);\n\t    };\n\t    User.prototype.manager = function (callback, odataQuery) {\n\t        this.graph.managerForUser(this._data.userPrincipalName, callback, odataQuery);\n\t    };\n\t    User.prototype.managerAsync = function (odataQuery) {\n\t        return this.graph.managerForUserAsync(this._data.userPrincipalName, odataQuery);\n\t    };\n\t    User.prototype.profilePhoto = function (callback, odataQuery) {\n\t        this.graph.profilePhotoForUser(this._data.userPrincipalName, callback, odataQuery);\n\t    };\n\t    User.prototype.profilePhotoAsync = function (odataQuery) {\n\t        return this.graph.profilePhotoForUserAsync(this._data.userPrincipalName, odataQuery);\n\t    };\n\t    User.prototype.profilePhotoValue = function (callback, odataQuery) {\n\t        this.graph.profilePhotoValueForUser(this._data.userPrincipalName, callback, odataQuery);\n\t    };\n\t    User.prototype.profilePhotoValueAsync = function (odataQuery) {\n\t        return this.graph.profilePhotoValueForUserAsync(this._data.userPrincipalName, odataQuery);\n\t    };\n\t    User.prototype.calendarView = function (callback, odataQuery) {\n\t        this.graph.eventsForUser(this._data.userPrincipalName, EventsEndpoint.calendarView, callback, odataQuery);\n\t    };\n\t    User.prototype.calendarViewAsync = function (odataQuery) {\n\t        return this.graph.eventsForUserAsync(this._data.userPrincipalName, EventsEndpoint.calendarView, odataQuery);\n\t    };\n\t    User.prototype.mailFolders = function (callback, odataQuery) {\n\t        this.graph.mailFoldersForUser(this._data.userPrincipalName, callback, odataQuery);\n\t    };\n\t    User.prototype.mailFoldersAsync = function (odataQuery) {\n\t        return this.graph.mailFoldersForUserAsync(this._data.userPrincipalName, odataQuery);\n\t    };\n\t    return User;\n\t}(DataModelWrapper));\n\texports.User = User;\n\tvar Users = (function (_super) {\n\t    __extends(Users, _super);\n\t    function Users() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    return Users;\n\t}(DataModelListWrapper));\n\texports.Users = Users;\n\tvar MessageDataModel = (function () {\n\t    function MessageDataModel() {\n\t    }\n\t    return MessageDataModel;\n\t}());\n\texports.MessageDataModel = MessageDataModel;\n\tvar Message = (function (_super) {\n\t    __extends(Message, _super);\n\t    function Message() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    return Message;\n\t}(DataModelWrapper));\n\texports.Message = Message;\n\tvar Messages = (function (_super) {\n\t    __extends(Messages, _super);\n\t    function Messages() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    return Messages;\n\t}(DataModelListWrapper));\n\texports.Messages = Messages;\n\tvar EventDataModel = (function () {\n\t    function EventDataModel() {\n\t    }\n\t    return EventDataModel;\n\t}());\n\texports.EventDataModel = EventDataModel;\n\tvar Event = (function (_super) {\n\t    __extends(Event, _super);\n\t    function Event() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    return Event;\n\t}(DataModelWrapper));\n\texports.Event = Event;\n\tvar Events = (function (_super) {\n\t    __extends(Events, _super);\n\t    function Events(graph, endpoint, _data) {\n\t        _super.call(this, graph, _data);\n\t        this.graph = graph;\n\t        this.endpoint = endpoint;\n\t        this._data = _data;\n\t    }\n\t    return Events;\n\t}(DataModelListWrapper));\n\texports.Events = Events;\n\tvar Contact = (function () {\n\t    function Contact() {\n\t    }\n\t    return Contact;\n\t}());\n\texports.Contact = Contact;\n\tvar GroupDataModel = (function () {\n\t    function GroupDataModel() {\n\t    }\n\t    return GroupDataModel;\n\t}());\n\texports.GroupDataModel = GroupDataModel;\n\tvar Group = (function (_super) {\n\t    __extends(Group, _super);\n\t    function Group() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    return Group;\n\t}(DataModelWrapper));\n\texports.Group = Group;\n\tvar Groups = (function (_super) {\n\t    __extends(Groups, _super);\n\t    function Groups() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    return Groups;\n\t}(DataModelListWrapper));\n\texports.Groups = Groups;\n\tvar MailFolderDataModel = (function () {\n\t    function MailFolderDataModel() {\n\t    }\n\t    return MailFolderDataModel;\n\t}());\n\texports.MailFolderDataModel = MailFolderDataModel;\n\tvar MailFolder = (function (_super) {\n\t    __extends(MailFolder, _super);\n\t    function MailFolder() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    return MailFolder;\n\t}(DataModelWrapper));\n\texports.MailFolder = MailFolder;\n\tvar MailFolders = (function (_super) {\n\t    __extends(MailFolders, _super);\n\t    function MailFolders() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    return MailFolders;\n\t}(DataModelListWrapper));\n\texports.MailFolders = MailFolders;\n\t(function (AttachmentType) {\n\t    AttachmentType[AttachmentType[\"fileAttachment\"] = 0] = \"fileAttachment\";\n\t    AttachmentType[AttachmentType[\"itemAttachment\"] = 1] = \"itemAttachment\";\n\t    AttachmentType[AttachmentType[\"referenceAttachment\"] = 2] = \"referenceAttachment\";\n\t})(exports.AttachmentType || (exports.AttachmentType = {}));\n\tvar AttachmentType = exports.AttachmentType;\n\tvar AttachmentDataModel = (function () {\n\t    function AttachmentDataModel() {\n\t    }\n\t    return AttachmentDataModel;\n\t}());\n\texports.AttachmentDataModel = AttachmentDataModel;\n\tvar Attachment = (function (_super) {\n\t    __extends(Attachment, _super);\n\t    function Attachment() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    Attachment.prototype.getType = function () {\n\t        switch (this._data['@odata.type']) {\n\t            case \"#microsoft.graph.fileAttachment\":\n\t                return AttachmentType.fileAttachment;\n\t            case \"#microsoft.graph.itemAttachment\":\n\t                return AttachmentType.itemAttachment;\n\t            case \"#microsoft.graph.referenceAttachment\":\n\t                return AttachmentType.referenceAttachment;\n\t        }\n\t    };\n\t    return Attachment;\n\t}(DataModelWrapper));\n\texports.Attachment = Attachment;\n\tvar Attachments = (function (_super) {\n\t    __extends(Attachments, _super);\n\t    function Attachments() {\n\t        _super.apply(this, arguments);\n\t    }\n\t    return Attachments;\n\t}(DataModelListWrapper));\n\texports.Attachments = Attachments;\n\tvar Graph = (function () {\n\t    function Graph(identityInfo) {\n\t        this.req = null;\n\t        this.accessToken = null;\n\t        this.KurveIdentity = null;\n\t        this.defaultResourceID = \"https://graph.microsoft.com\";\n\t        this.baseUrl = \"https://graph.microsoft.com/v1.0/\";\n\t        if (identityInfo.defaultAccessToken) {\n\t            this.accessToken = identityInfo.defaultAccessToken;\n\t        }\n\t        else {\n\t            this.KurveIdentity = identityInfo.identity;\n\t        }\n\t    }\n\t    Graph.prototype.scopesForV2 = function (scopes) {\n\t        if (!this.KurveIdentity)\n\t            return null;\n\t        if (this.KurveIdentity.getCurrentOauthVersion() === identity_1.OAuthVersion.v1)\n\t            return null;\n\t        else\n\t            return scopes;\n\t    };\n\t    Graph.prototype.meAsync = function (odataQuery) {\n\t        var d = new promises_1.Deferred();\n\t        this.me(function (user, error) { return error ? d.reject(error) : d.resolve(user); }, odataQuery);\n\t        return d.promise;\n\t    };\n\t    Graph.prototype.me = function (callback, odataQuery) {\n\t        var scopes = [Scopes.User.Read];\n\t        var urlString = this.buildMeUrl(\"\", odataQuery);\n\t        this.getUser(urlString, callback, this.scopesForV2(scopes));\n\t    };\n\t    Graph.prototype.userAsync = function (userId, odataQuery, basicProfileOnly) {\n\t        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\n\t        var d = new promises_1.Deferred();\n\t        this.user(userId, function (user, error) { return error ? d.reject(error) : d.resolve(user); }, odataQuery, basicProfileOnly);\n\t        return d.promise;\n\t    };\n\t    Graph.prototype.user = function (userId, callback, odataQuery, basicProfileOnly) {\n\t        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\n\t        var scopes = basicProfileOnly ? [Scopes.User.ReadBasicAll] : [Scopes.User.ReadAll];\n\t        var urlString = this.buildUsersUrl(userId, odataQuery);\n\t        this.getUser(urlString, callback, this.scopesForV2(scopes));\n\t    };\n\t    Graph.prototype.usersAsync = function (odataQuery, basicProfileOnly) {\n\t        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\n\t        var d = new promises_1.Deferred();\n\t        this.users(function (users, error) { return error ? d.reject(error) : d.resolve(users); }, odataQuery, basicProfileOnly);\n\t        return d.promise;\n\t    };\n\t    Graph.prototype.users = function (callback, odataQuery, basicProfileOnly) {\n\t        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\n\t        var scopes = basicProfileOnly ? [Scopes.User.ReadBasicAll] : [Scopes.User.ReadAll];\n\t        var urlString = this.buildUsersUrl(\"\", odataQuery);\n\t        this.getUsers(urlString, callback, this.scopesForV2(scopes), basicProfileOnly);\n\t    };\n\t    Graph.prototype.groupAsync = function (groupId, odataQuery) {\n\t        var d = new promises_1.Deferred();\n\t        this.group(groupId, function (group, error) { return error ? d.reject(error) : d.resolve(group); }, odataQuery);\n\t        return d.promise;\n\t    };\n\t    Graph.prototype.group = function (groupId, callback, odataQuery) {\n\t        var scopes = [Scopes.Group.ReadAll];\n\t        var urlString = this.buildGroupsUrl(groupId, odataQuery);\n\t        this.getGroup(urlString, callback, this.scopesForV2(scopes));\n\t    };\n\t    Graph.prototype.groupsAsync = function (odataQuery) {\n\t        var d = new promises_1.Deferred();\n\t        this.groups(function (groups, error) { return error ? d.reject(error) : d.resolve(groups); }, odataQuery);\n\t        return d.promise;\n\t    };\n\t    Graph.prototype.groups = function (callback, odataQuery) {\n\t        var scopes = [Scopes.Group.ReadAll];\n\t        var urlString = this.buildGroupsUrl(\"\", odataQuery);\n\t        this.getGroups(urlString, callback, this.scopesForV2(scopes));\n\t    };\n\t    Graph.prototype.messagesForUserAsync = function (userPrincipalName, odataQuery) {\n\t        var d = new promises_1.Deferred();\n\t        this.messagesForUser(userPrincipalName, function (messages, error) { return error ? d.reject(error) : d.resolve(messages); }, odataQuery);\n\t        return d.promise;\n\t    };\n\t    Graph.prototype.messagesForUser = function (userPrincipalName, callback, odataQuery) {\n\t        var scopes = [Scopes.Mail.Read];\n\t        var urlString = this.buildUsersUrl(userPrincipalName + \"/messages\", odataQuery);\n\t        this.getMessages(urlString, function (result, error) { return callback(result, error); }, this.scopesForV2(scopes));\n\t    };\n\t    Graph.prototype.mailFoldersForUserAsync = function (userPrincipalName, odataQuery) {\n\t        var d = new promises_1.Deferred();\n\t        this.mailFoldersForUser(userPrincipalName, function (messages, error) { return error ? d.reject(error) : d.resolve(messages); }, odataQuery);\n\t        return d.promise;\n\t    };\n\t    Graph.prototype.mailFoldersForUser = function (userPrincipalName, callback, odataQuery) {\n\t        var scopes = [Scopes.Mail.Read];\n\t        var urlString = this.buildUsersUrl(userPrincipalName + \"/mailFolders\", odataQuery);\n\t        this.getMailFolders(urlString, function (result, error) { return callback(result, error); }, this.scopesForV2(scopes));\n\t    };\n\t    Graph.prototype.eventsForUserAsync = function (userPrincipalName, endpoint, odataQuery) {\n\t        var d = new promises_1.Deferred();\n\t        this.eventsForUser(userPrincipalName, endpoint, function (events, error) { return error ? d.reject(error) : d.resolve(events); }, odataQuery);\n\t        return d.promise;\n\t    };\n\t    Graph.prototype.eventsForUser = function (userPrincipalName, endpoint, callback, odataQuery) {\n\t        var scopes = [Scopes.Calendars.Read];\n\t        var urlString = this.buildUsersUrl(userPrincipalName + \"/\" + EventsEndpoint[endpoint], odataQuery);\n\t        this.getEvents(urlString, endpoint, function (result, error) { return callback(result, error); }, this.scopesForV2(scopes));\n\t    };\n\t    Graph.prototype.memberOfForUserAsync = function (userPrincipalName, odataQuery) {\n\t        var d = new promises_1.Deferred();\n\t        this.memberOfForUser(userPrincipalName, function (groups, error) { return error ? d.reject(error) : d.resolve(groups); }, odataQuery);\n\t        return d.promise;\n\t    };\n\t    Graph.prototype.memberOfForUser = function (userPrincipalName, callback, odataQuery) {\n\t        var scopes = [Scopes.Group.ReadAll];\n\t        var urlString = this.buildUsersUrl(userPrincipalName + \"/memberOf\", odataQuery);\n\t        this.getGroups(urlString, callback, this.scopesForV2(scopes));\n\t    };\n\t    Graph.prototype.managerForUserAsync = function (userPrincipalName, odataQuery) {\n\t        var d = new promises_1.Deferred();\n\t        this.managerForUser(userPrincipalName, function (user, error) { return error ? d.reject(error) : d.resolve(user); }, odataQuery);\n\t        return d.promise;\n\t    };\n\t    Graph.prototype.managerForUser = function (userPrincipalName, callback, odataQuery) {\n\t        var scopes = [Scopes.Directory.ReadAll];\n\t        var urlString = this.buildUsersUrl(userPrincipalName + \"/manager\", odataQuery);\n\t        this.getUser(urlString, callback, this.scopesForV2(scopes));\n\t    };\n\t    Graph.prototype.directReportsForUserAsync = function (userPrincipalName, odataQuery) {\n\t        var d = new promises_1.Deferred();\n\t        this.directReportsForUser(userPrincipalName, function (users, error) { return error ? d.reject(error) : d.resolve(users); }, odataQuery);\n\t        return d.promise;\n\t    };\n\t    Graph.prototype.directReportsForUser = function (userPrincipalName, callback, odataQuery) {\n\t        var scopes = [Scopes.Directory.ReadAll];\n\t        var urlString = this.buildUsersUrl(userPrincipalName + \"/directReports\", odataQuery);\n\t        this.getUsers(urlString, callback, this.scopesForV2(scopes));\n\t    };\n\t    Graph.prototype.profilePhotoForUserAsync = function (userPrincipalName, odataQuery) {\n\t        var d = new promises_1.Deferred();\n\t        this.profilePhotoForUser(userPrincipalName, function (profilePhoto, error) { return error ? d.reject(error) : d.resolve(profilePhoto); }, odataQuery);\n\t        return d.promise;\n\t    };\n\t    Graph.prototype.profilePhotoForUser = function (userPrincipalName, callback, odataQuery) {\n\t        var scopes = [Scopes.User.ReadBasicAll];\n\t        var urlString = this.buildUsersUrl(userPrincipalName + \"/photo\", odataQuery);\n\t        this.getPhoto(urlString, callback, this.scopesForV2(scopes));\n\t    };\n\t    Graph.prototype.profilePhotoValueForUserAsync = function (userPrincipalName, odataQuery) {\n\t        var d = new promises_1.Deferred();\n\t        this.profilePhotoValueForUser(userPrincipalName, function (result, error) { return error ? d.reject(error) : d.resolve(result); }, odataQuery);\n\t        return d.promise;\n\t    };\n\t    Graph.prototype.profilePhotoValueForUser = function (userPrincipalName, callback, odataQuery) {\n\t        var scopes = [Scopes.User.ReadBasicAll];\n\t        var urlString = this.buildUsersUrl(userPrincipalName + \"/photo/$value\", odataQuery);\n\t        this.getPhotoValue(urlString, callback, this.scopesForV2(scopes));\n\t    };\n\t    Graph.prototype.messageAttachmentsForUserAsync = function (userPrincipalName, messageId, odataQuery) {\n\t        var d = new promises_1.Deferred();\n\t        this.messageAttachmentsForUser(userPrincipalName, messageId, function (result, error) { return error ? d.reject(error) : d.resolve(result); }, odataQuery);\n\t        return d.promise;\n\t    };\n\t    Graph.prototype.messageAttachmentsForUser = function (userPrincipalName, messageId, callback, odataQuery) {\n\t        var scopes = [Scopes.Mail.Read];\n\t        var urlString = this.buildUsersUrl(userPrincipalName + \"/messages/\" + messageId + \"/attachments\", odataQuery);\n\t        this.getMessageAttachments(urlString, callback, this.scopesForV2(scopes));\n\t    };\n\t    Graph.prototype.messageAttachmentForUserAsync = function (userPrincipalName, messageId, attachmentId, odataQuery) {\n\t        var d = new promises_1.Deferred();\n\t        this.messageAttachmentForUser(userPrincipalName, messageId, attachmentId, function (attachment, error) { return error ? d.reject(error) : d.resolve(attachment); }, odataQuery);\n\t        return d.promise;\n\t    };\n\t    Graph.prototype.messageAttachmentForUser = function (userPrincipalName, messageId, attachmentId, callback, odataQuery) {\n\t        var scopes = [Scopes.Mail.Read];\n\t        var urlString = this.buildUsersUrl(userPrincipalName + \"/messages/\" + messageId + \"/attachments/\" + attachmentId, odataQuery);\n\t        this.getMessageAttachment(urlString, callback, this.scopesForV2(scopes));\n\t    };\n\t    Graph.prototype.getAsync = function (url) {\n\t        var d = new promises_1.Deferred();\n\t        this.get(url, function (response, error) { return error ? d.reject(error) : d.resolve(response); });\n\t        return d.promise;\n\t    };\n\t    Graph.prototype.get = function (url, callback, responseType, scopes) {\n\t        var _this = this;\n\t        var xhr = new XMLHttpRequest();\n\t        if (responseType)\n\t            xhr.responseType = responseType;\n\t        xhr.onreadystatechange = function () {\n\t            if (xhr.readyState === 4)\n\t                if (xhr.status === 200)\n\t                    callback(responseType ? xhr.response : xhr.responseText, null);\n\t                else\n\t                    callback(null, _this.generateError(xhr));\n\t        };\n\t        xhr.open(\"GET\", url);\n\t        this.addAccessTokenAndSend(xhr, function (addTokenError) {\n\t            if (addTokenError) {\n\t                callback(null, addTokenError);\n\t            }\n\t        }, scopes);\n\t    };\n\t    Graph.prototype.generateError = function (xhr) {\n\t        var response = new identity_1.Error();\n\t        response.status = xhr.status;\n\t        response.statusText = xhr.statusText;\n\t        if (xhr.responseType === '' || xhr.responseType === 'text')\n\t            response.text = xhr.responseText;\n\t        else\n\t            response.other = xhr.response;\n\t        return response;\n\t    };\n\t    Graph.prototype.getUsers = function (urlString, callback, scopes, basicProfileOnly) {\n\t        var _this = this;\n\t        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\n\t        this.get(urlString, function (result, errorGet) {\n\t            if (errorGet) {\n\t                callback(null, errorGet);\n\t                return;\n\t            }\n\t            var usersODATA = JSON.parse(result);\n\t            if (usersODATA.error) {\n\t                var errorODATA = new identity_1.Error();\n\t                errorODATA.other = usersODATA.error;\n\t                callback(null, errorODATA);\n\t                return;\n\t            }\n\t            var resultsArray = (usersODATA.value ? usersODATA.value : [usersODATA]);\n\t            var users = new Users(_this, resultsArray.map(function (o) { return new User(_this, o); }));\n\t            var nextLink = usersODATA['@odata.nextLink'];\n\t            if (nextLink) {\n\t                users.nextLink = function (callback) {\n\t                    var scopes = basicProfileOnly ? [Scopes.User.ReadBasicAll] : [Scopes.User.ReadAll];\n\t                    var d = new promises_1.Deferred();\n\t                    _this.getUsers(nextLink, function (result, error) {\n\t                        if (callback)\n\t                            callback(result, error);\n\t                        else\n\t                            error ? d.reject(error) : d.resolve(result);\n\t                    }, _this.scopesForV2(scopes), basicProfileOnly);\n\t                    return d.promise;\n\t                };\n\t            }\n\t            callback(users, null);\n\t        }, null, scopes);\n\t    };\n\t    Graph.prototype.getUser = function (urlString, callback, scopes) {\n\t        var _this = this;\n\t        this.get(urlString, function (result, errorGet) {\n\t            if (errorGet) {\n\t                callback(null, errorGet);\n\t                return;\n\t            }\n\t            var userODATA = JSON.parse(result);\n\t            if (userODATA.error) {\n\t                var errorODATA = new identity_1.Error();\n\t                errorODATA.other = userODATA.error;\n\t                callback(null, errorODATA);\n\t                return;\n\t            }\n\t            var user = new User(_this, userODATA);\n\t            callback(user, null);\n\t        }, null, scopes);\n\t    };\n\t    Graph.prototype.addAccessTokenAndSend = function (xhr, callback, scopes) {\n\t        if (this.accessToken) {\n\t            xhr.setRequestHeader('Authorization', 'Bearer ' + this.accessToken);\n\t            xhr.send();\n\t        }\n\t        else {\n\t            if (scopes) {\n\t                this.KurveIdentity.getAccessTokenForScopes(scopes, false, (function (token, error) {\n\t                    if (error)\n\t                        callback(error);\n\t                    else {\n\t                        xhr.setRequestHeader('Authorization', 'Bearer ' + token);\n\t                        xhr.send();\n\t                        callback(null);\n\t                    }\n\t                }));\n\t            }\n\t            else {\n\t                this.KurveIdentity.getAccessToken(this.defaultResourceID, (function (token, error) {\n\t                    if (error)\n\t                        callback(error);\n\t                    else {\n\t                        xhr.setRequestHeader('Authorization', 'Bearer ' + token);\n\t                        xhr.send();\n\t                        callback(null);\n\t                    }\n\t                }));\n\t            }\n\t        }\n\t    };\n\t    Graph.prototype.getMessages = function (urlString, callback, scopes) {\n\t        var _this = this;\n\t        this.get(urlString, function (result, errorGet) {\n\t            if (errorGet) {\n\t                callback(null, errorGet);\n\t                return;\n\t            }\n\t            var messagesODATA = JSON.parse(result);\n\t            if (messagesODATA.error) {\n\t                var errorODATA = new identity_1.Error();\n\t                errorODATA.other = messagesODATA.error;\n\t                callback(null, errorODATA);\n\t                return;\n\t            }\n\t            var resultsArray = (messagesODATA.value ? messagesODATA.value : [messagesODATA]);\n\t            var messages = new Messages(_this, resultsArray.map(function (o) { return new Message(_this, o); }));\n\t            var nextLink = messagesODATA['@odata.nextLink'];\n\t            if (nextLink) {\n\t                messages.nextLink = function (callback) {\n\t                    var scopes = [Scopes.Mail.Read];\n\t                    var d = new promises_1.Deferred();\n\t                    _this.getMessages(nextLink, function (messages, error) {\n\t                        if (callback)\n\t                            callback(messages, error);\n\t                        else\n\t                            error ? d.reject(error) : d.resolve(messages);\n\t                    }, _this.scopesForV2(scopes));\n\t                    return d.promise;\n\t                };\n\t            }\n\t            callback(messages, null);\n\t        }, null, scopes);\n\t    };\n\t    Graph.prototype.getEvents = function (urlString, endpoint, callback, scopes) {\n\t        var _this = this;\n\t        this.get(urlString, function (result, errorGet) {\n\t            if (errorGet) {\n\t                callback(null, errorGet);\n\t                return;\n\t            }\n\t            var odata = JSON.parse(result);\n\t            if (odata.error) {\n\t                var errorODATA = new identity_1.Error();\n\t                errorODATA.other = odata.error;\n\t                callback(null, errorODATA);\n\t                return;\n\t            }\n\t            var resultsArray = (odata.value ? odata.value : [odata]);\n\t            var events = new Events(_this, endpoint, resultsArray.map(function (o) { return new Event(_this, o); }));\n\t            var nextLink = odata['@odata.nextLink'];\n\t            if (nextLink) {\n\t                events.nextLink = function (callback) {\n\t                    var scopes = [Scopes.Mail.Read];\n\t                    var d = new promises_1.Deferred();\n\t                    _this.getEvents(nextLink, endpoint, function (result, error) {\n\t                        if (callback)\n\t                            callback(result, error);\n\t                        else\n\t                            error ? d.reject(error) : d.resolve(result);\n\t                    }, _this.scopesForV2(scopes));\n\t                    return d.promise;\n\t                };\n\t            }\n\t            callback(events, null);\n\t        }, null, scopes);\n\t    };\n\t    Graph.prototype.getGroups = function (urlString, callback, scopes) {\n\t        var _this = this;\n\t        this.get(urlString, function (result, errorGet) {\n\t            if (errorGet) {\n\t                callback(null, errorGet);\n\t                return;\n\t            }\n\t            var groupsODATA = JSON.parse(result);\n\t            if (groupsODATA.error) {\n\t                var errorODATA = new identity_1.Error();\n\t                errorODATA.other = groupsODATA.error;\n\t                callback(null, errorODATA);\n\t                return;\n\t            }\n\t            var resultsArray = (groupsODATA.value ? groupsODATA.value : [groupsODATA]);\n\t            var groups = new Groups(_this, resultsArray.map(function (o) { return new Group(_this, o); }));\n\t            var nextLink = groupsODATA['@odata.nextLink'];\n\t            if (nextLink) {\n\t                groups.nextLink = function (callback) {\n\t                    var scopes = [Scopes.Group.ReadAll];\n\t                    var d = new promises_1.Deferred();\n\t                    _this.getGroups(nextLink, function (result, error) {\n\t                        if (callback)\n\t                            callback(result, error);\n\t                        else\n\t                            error ? d.reject(error) : d.resolve(result);\n\t                    }, _this.scopesForV2(scopes));\n\t                    return d.promise;\n\t                };\n\t            }\n\t            callback(groups, null);\n\t        }, null, scopes);\n\t    };\n\t    Graph.prototype.getGroup = function (urlString, callback, scopes) {\n\t        var _this = this;\n\t        this.get(urlString, function (result, errorGet) {\n\t            if (errorGet) {\n\t                callback(null, errorGet);\n\t                return;\n\t            }\n\t            var ODATA = JSON.parse(result);\n\t            if (ODATA.error) {\n\t                var ODATAError = new identity_1.Error();\n\t                ODATAError.other = ODATA.error;\n\t                callback(null, ODATAError);\n\t                return;\n\t            }\n\t            var group = new Group(_this, ODATA);\n\t            callback(group, null);\n\t        }, null, scopes);\n\t    };\n\t    Graph.prototype.getPhoto = function (urlString, callback, scopes) {\n\t        var _this = this;\n\t        this.get(urlString, function (result, errorGet) {\n\t            if (errorGet) {\n\t                callback(null, errorGet);\n\t                return;\n\t            }\n\t            var ODATA = JSON.parse(result);\n\t            if (ODATA.error) {\n\t                var errorODATA = new identity_1.Error();\n\t                errorODATA.other = ODATA.error;\n\t                callback(null, errorODATA);\n\t                return;\n\t            }\n\t            var photo = new ProfilePhoto(_this, ODATA);\n\t            callback(photo, null);\n\t        }, null, scopes);\n\t    };\n\t    Graph.prototype.getPhotoValue = function (urlString, callback, scopes) {\n\t        this.get(urlString, function (result, errorGet) {\n\t            if (errorGet) {\n\t                callback(null, errorGet);\n\t                return;\n\t            }\n\t            callback(result, null);\n\t        }, \"blob\", scopes);\n\t    };\n\t    Graph.prototype.getMailFolders = function (urlString, callback, scopes) {\n\t        var _this = this;\n\t        this.get(urlString, function (result, errorGet) {\n\t            if (errorGet) {\n\t                callback(null, errorGet);\n\t                return;\n\t            }\n\t            var odata = JSON.parse(result);\n\t            if (odata.error) {\n\t                var errorODATA = new identity_1.Error();\n\t                errorODATA.other = odata.error;\n\t                callback(null, errorODATA);\n\t            }\n\t            var resultsArray = (odata.value ? odata.value : [odata]);\n\t            var mailFolders = new MailFolders(_this, resultsArray.map(function (o) { return new MailFolder(_this, o); }));\n\t            var nextLink = odata['@odata.nextLink'];\n\t            if (nextLink) {\n\t                mailFolders.nextLink = function (callback) {\n\t                    var scopes = [Scopes.User.ReadAll];\n\t                    var d = new promises_1.Deferred();\n\t                    _this.getMailFolders(nextLink, function (result, error) {\n\t                        if (callback)\n\t                            callback(result, error);\n\t                        else\n\t                            error ? d.reject(error) : d.resolve(result);\n\t                    }, _this.scopesForV2(scopes));\n\t                    return d.promise;\n\t                };\n\t            }\n\t            callback(mailFolders, null);\n\t        }, null, scopes);\n\t    };\n\t    Graph.prototype.getMessageAttachments = function (urlString, callback, scopes) {\n\t        var _this = this;\n\t        this.get(urlString, function (result, errorGet) {\n\t            if (errorGet) {\n\t                callback(null, errorGet);\n\t                return;\n\t            }\n\t            var attachmentsODATA = JSON.parse(result);\n\t            if (attachmentsODATA.error) {\n\t                var errorODATA = new identity_1.Error();\n\t                errorODATA.other = attachmentsODATA.error;\n\t                callback(null, errorODATA);\n\t                return;\n\t            }\n\t            var resultsArray = (attachmentsODATA.value ? attachmentsODATA.value : [attachmentsODATA]);\n\t            var attachments = new Attachments(_this, resultsArray.map(function (o) { return new Attachment(_this, o); }));\n\t            var nextLink = attachmentsODATA['@odata.nextLink'];\n\t            if (nextLink) {\n\t                attachments.nextLink = function (callback) {\n\t                    var scopes = [Scopes.Mail.Read];\n\t                    var d = new promises_1.Deferred();\n\t                    _this.getMessageAttachments(nextLink, function (attachments, error) {\n\t                        if (callback)\n\t                            callback(attachments, error);\n\t                        else\n\t                            error ? d.reject(error) : d.resolve(attachments);\n\t                    }, _this.scopesForV2(scopes));\n\t                    return d.promise;\n\t                };\n\t            }\n\t            callback(attachments, null);\n\t        }, null, scopes);\n\t    };\n\t    Graph.prototype.getMessageAttachment = function (urlString, callback, scopes) {\n\t        var _this = this;\n\t        this.get(urlString, function (result, errorGet) {\n\t            if (errorGet) {\n\t                callback(null, errorGet);\n\t                return;\n\t            }\n\t            var ODATA = JSON.parse(result);\n\t            if (ODATA.error) {\n\t                var ODATAError = new identity_1.Error();\n\t                ODATAError.other = ODATA.error;\n\t                callback(null, ODATAError);\n\t                return;\n\t            }\n\t            var attachment = new Attachment(_this, ODATA);\n\t            callback(attachment, null);\n\t        }, null, scopes);\n\t    };\n\t    Graph.prototype.buildUrl = function (root, path, odataQuery) {\n\t        return this.baseUrl + root + path + (odataQuery ? \"?\" + odataQuery : \"\");\n\t    };\n\t    Graph.prototype.buildMeUrl = function (path, odataQuery) {\n\t        if (path === void 0) { path = \"\"; }\n\t        return this.buildUrl(\"me/\", path, odataQuery);\n\t    };\n\t    Graph.prototype.buildUsersUrl = function (path, odataQuery) {\n\t        if (path === void 0) { path = \"\"; }\n\t        return this.buildUrl(\"users/\", path, odataQuery);\n\t    };\n\t    Graph.prototype.buildGroupsUrl = function (path, odataQuery) {\n\t        if (path === void 0) { path = \"\"; }\n\t        return this.buildUrl(\"groups/\", path, odataQuery);\n\t    };\n\t    return Graph;\n\t}());\n\texports.Graph = Graph;\n\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\tfunction DispatchDeferred(closure) {\n\t    setTimeout(closure, 0);\n\t}\n\tvar PromiseState;\n\t(function (PromiseState) {\n\t    PromiseState[PromiseState[\"Pending\"] = 0] = \"Pending\";\n\t    PromiseState[PromiseState[\"ResolutionInProgress\"] = 1] = \"ResolutionInProgress\";\n\t    PromiseState[PromiseState[\"Resolved\"] = 2] = \"Resolved\";\n\t    PromiseState[PromiseState[\"Rejected\"] = 3] = \"Rejected\";\n\t})(PromiseState || (PromiseState = {}));\n\tvar Client = (function () {\n\t    function Client(_dispatcher, _successCB, _errorCB) {\n\t        this._dispatcher = _dispatcher;\n\t        this._successCB = _successCB;\n\t        this._errorCB = _errorCB;\n\t        this.result = new Deferred(_dispatcher);\n\t    }\n\t    Client.prototype.resolve = function (value, defer) {\n\t        var _this = this;\n\t        if (typeof (this._successCB) !== 'function') {\n\t            this.result.resolve(value);\n\t            return;\n\t        }\n\t        if (defer) {\n\t            this._dispatcher(function () { return _this._dispatchCallback(_this._successCB, value); });\n\t        }\n\t        else {\n\t            this._dispatchCallback(this._successCB, value);\n\t        }\n\t    };\n\t    Client.prototype.reject = function (error, defer) {\n\t        var _this = this;\n\t        if (typeof (this._errorCB) !== 'function') {\n\t            this.result.reject(error);\n\t            return;\n\t        }\n\t        if (defer) {\n\t            this._dispatcher(function () { return _this._dispatchCallback(_this._errorCB, error); });\n\t        }\n\t        else {\n\t            this._dispatchCallback(this._errorCB, error);\n\t        }\n\t    };\n\t    Client.prototype._dispatchCallback = function (callback, arg) {\n\t        var result, then, type;\n\t        try {\n\t            result = callback(arg);\n\t            this.result.resolve(result);\n\t        }\n\t        catch (err) {\n\t            this.result.reject(err);\n\t            return;\n\t        }\n\t    };\n\t    return Client;\n\t}());\n\tvar Deferred = (function () {\n\t    function Deferred(dispatcher) {\n\t        this._stack = [];\n\t        this._state = PromiseState.Pending;\n\t        if (dispatcher)\n\t            this._dispatcher = dispatcher;\n\t        else\n\t            this._dispatcher = DispatchDeferred;\n\t        this.promise = new Promise(this);\n\t    }\n\t    Deferred.prototype.DispatchDeferred = function (closure) {\n\t        setTimeout(closure, 0);\n\t    };\n\t    Deferred.prototype.then = function (successCB, errorCB) {\n\t        if (typeof (successCB) !== 'function' && typeof (errorCB) !== 'function') {\n\t            return this.promise;\n\t        }\n\t        var client = new Client(this._dispatcher, successCB, errorCB);\n\t        switch (this._state) {\n\t            case PromiseState.Pending:\n\t            case PromiseState.ResolutionInProgress:\n\t                this._stack.push(client);\n\t                break;\n\t            case PromiseState.Resolved:\n\t                client.resolve(this._value, true);\n\t                break;\n\t            case PromiseState.Rejected:\n\t                client.reject(this._error, true);\n\t                break;\n\t        }\n\t        return client.result.promise;\n\t    };\n\t    Deferred.prototype.resolve = function (value) {\n\t        if (this._state !== PromiseState.Pending) {\n\t            return this;\n\t        }\n\t        return this._resolve(value);\n\t    };\n\t    Deferred.prototype._resolve = function (value) {\n\t        var _this = this;\n\t        var type = typeof (value), then, pending = true;\n\t        try {\n\t            if (value !== null &&\n\t                (type === 'object' || type === 'function') &&\n\t                typeof (then = value.then) === 'function') {\n\t                if (value === this.promise) {\n\t                    throw new TypeError('recursive resolution');\n\t                }\n\t                this._state = PromiseState.ResolutionInProgress;\n\t                then.call(value, function (result) {\n\t                    if (pending) {\n\t                        pending = false;\n\t                        _this._resolve(result);\n\t                    }\n\t                }, function (error) {\n\t                    if (pending) {\n\t                        pending = false;\n\t                        _this._reject(error);\n\t                    }\n\t                });\n\t            }\n\t            else {\n\t                this._state = PromiseState.ResolutionInProgress;\n\t                this._dispatcher(function () {\n\t                    _this._state = PromiseState.Resolved;\n\t                    _this._value = value;\n\t                    var i, stackSize = _this._stack.length;\n\t                    for (i = 0; i < stackSize; i++) {\n\t                        _this._stack[i].resolve(value, false);\n\t                    }\n\t                    _this._stack.splice(0, stackSize);\n\t                });\n\t            }\n\t        }\n\t        catch (err) {\n\t            if (pending) {\n\t                this._reject(err);\n\t            }\n\t        }\n\t        return this;\n\t    };\n\t    Deferred.prototype.reject = function (error) {\n\t        if (this._state !== PromiseState.Pending) {\n\t            return this;\n\t        }\n\t        return this._reject(error);\n\t    };\n\t    Deferred.prototype._reject = function (error) {\n\t        var _this = this;\n\t        this._state = PromiseState.ResolutionInProgress;\n\t        this._dispatcher(function () {\n\t            _this._state = PromiseState.Rejected;\n\t            _this._error = error;\n\t            var stackSize = _this._stack.length, i = 0;\n\t            for (i = 0; i < stackSize; i++) {\n\t                _this._stack[i].reject(error, false);\n\t            }\n\t            _this._stack.splice(0, stackSize);\n\t        });\n\t        return this;\n\t    };\n\t    return Deferred;\n\t}());\n\texports.Deferred = Deferred;\n\tvar Promise = (function () {\n\t    function Promise(_deferred) {\n\t        this._deferred = _deferred;\n\t    }\n\t    Promise.prototype.then = function (successCallback, errorCallback) {\n\t        return this._deferred.then(successCallback, errorCallback);\n\t    };\n\t    Promise.prototype.fail = function (errorCallback) {\n\t        return this._deferred.then(undefined, errorCallback);\n\t    };\n\t    return Promise;\n\t}());\n\texports.Promise = Promise;\n\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar promises_1 = __webpack_require__(2);\n\t(function (OAuthVersion) {\n\t    OAuthVersion[OAuthVersion[\"v1\"] = 1] = \"v1\";\n\t    OAuthVersion[OAuthVersion[\"v2\"] = 2] = \"v2\";\n\t})(exports.OAuthVersion || (exports.OAuthVersion = {}));\n\tvar OAuthVersion = exports.OAuthVersion;\n\tvar Error = (function () {\n\t    function Error() {\n\t    }\n\t    return Error;\n\t}());\n\texports.Error = Error;\n\tvar CachedToken = (function () {\n\t    function CachedToken(id, scopes, resource, token, expiry) {\n\t        this.id = id;\n\t        this.scopes = scopes;\n\t        this.resource = resource;\n\t        this.token = token;\n\t        this.expiry = expiry;\n\t    }\n\t    ;\n\t    Object.defineProperty(CachedToken.prototype, \"isExpired\", {\n\t        get: function () {\n\t            return this.expiry <= new Date(new Date().getTime() + 60000);\n\t        },\n\t        enumerable: true,\n\t        configurable: true\n\t    });\n\t    CachedToken.prototype.hasScopes = function (requiredScopes) {\n\t        var _this = this;\n\t        if (!this.scopes) {\n\t            return false;\n\t        }\n\t        return requiredScopes.every(function (requiredScope) {\n\t            return _this.scopes.some(function (actualScope) { return requiredScope === actualScope; });\n\t        });\n\t    };\n\t    return CachedToken;\n\t}());\n\tvar TokenCache = (function () {\n\t    function TokenCache(tokenStorage) {\n\t        var _this = this;\n\t        this.tokenStorage = tokenStorage;\n\t        this.cachedTokens = {};\n\t        if (tokenStorage) {\n\t            tokenStorage.getAll().forEach(function (_a) {\n\t                var id = _a.id, scopes = _a.scopes, resource = _a.resource, token = _a.token, expiry = _a.expiry;\n\t                var cachedToken = new CachedToken(id, scopes, resource, token, new Date(expiry));\n\t                if (cachedToken.isExpired) {\n\t                    _this.tokenStorage.remove(cachedToken.id);\n\t                }\n\t                else {\n\t                    _this.cachedTokens[cachedToken.id] = cachedToken;\n\t                }\n\t            });\n\t        }\n\t    }\n\t    TokenCache.prototype.add = function (token) {\n\t        this.cachedTokens[token.id] = token;\n\t        this.tokenStorage && this.tokenStorage.add(token.id, token);\n\t    };\n\t    TokenCache.prototype.getForResource = function (resource) {\n\t        var cachedToken = this.cachedTokens[resource];\n\t        if (cachedToken && cachedToken.isExpired) {\n\t            this.remove(resource);\n\t            return null;\n\t        }\n\t        return cachedToken;\n\t    };\n\t    TokenCache.prototype.getForScopes = function (scopes) {\n\t        for (var key in this.cachedTokens) {\n\t            var cachedToken = this.cachedTokens[key];\n\t            if (cachedToken.hasScopes(scopes)) {\n\t                if (cachedToken.isExpired) {\n\t                    this.remove(key);\n\t                }\n\t                else {\n\t                    return cachedToken;\n\t                }\n\t            }\n\t        }\n\t        return null;\n\t    };\n\t    TokenCache.prototype.clear = function () {\n\t        this.cachedTokens = {};\n\t        this.tokenStorage && this.tokenStorage.clear();\n\t    };\n\t    TokenCache.prototype.remove = function (key) {\n\t        this.tokenStorage && this.tokenStorage.remove(key);\n\t        delete this.cachedTokens[key];\n\t    };\n\t    return TokenCache;\n\t}());\n\tvar IdToken = (function () {\n\t    function IdToken() {\n\t    }\n\t    return IdToken;\n\t}());\n\texports.IdToken = IdToken;\n\tvar Identity = (function () {\n\t    function Identity(identitySettings) {\n\t        var _this = this;\n\t        this.policy = \"\";\n\t        this.clientId = identitySettings.clientId;\n\t        this.tokenProcessorUrl = identitySettings.tokenProcessingUri;\n\t        if (identitySettings.version)\n\t            this.version = identitySettings.version;\n\t        else\n\t            this.version = OAuthVersion.v1;\n\t        this.tokenCache = new TokenCache(identitySettings.tokenStorage);\n\t        window.addEventListener(\"message\", function (event) {\n\t            if (event.data.type === \"id_token\") {\n\t                if (event.data.error) {\n\t                    var e = new Error();\n\t                    e.text = event.data.error;\n\t                    _this.loginCallback(e);\n\t                }\n\t                else {\n\t                    if (_this.state !== event.data.state) {\n\t                        var error = new Error();\n\t                        error.statusText = \"Invalid state\";\n\t                        _this.loginCallback(error);\n\t                    }\n\t                    else {\n\t                        _this.decodeIdToken(event.data.token);\n\t                        _this.loginCallback(null);\n\t                    }\n\t                }\n\t            }\n\t            else if (event.data.type === \"access_token\") {\n\t                if (event.data.error) {\n\t                    var e = new Error();\n\t                    e.text = event.data.error;\n\t                    _this.getTokenCallback(null, e);\n\t                }\n\t                else {\n\t                    var token = event.data.token;\n\t                    var iframe = document.getElementById(\"tokenIFrame\");\n\t                    iframe.parentNode.removeChild(iframe);\n\t                    if (event.data.state !== _this.state) {\n\t                        var error = new Error();\n\t                        error.statusText = \"Invalid state\";\n\t                        _this.getTokenCallback(null, error);\n\t                    }\n\t                    else {\n\t                        _this.getTokenCallback(token, null);\n\t                    }\n\t                }\n\t            }\n\t        });\n\t    }\n\t    Identity.prototype.checkForIdentityRedirect = function () {\n\t        function token(s) {\n\t            var start = window.location.href.indexOf(s);\n\t            if (start < 0)\n\t                return null;\n\t            var end = window.location.href.indexOf(\"&\", start + s.length);\n\t            return window.location.href.substring(start, ((end > 0) ? end : window.location.href.length));\n\t        }\n\t        function parseQueryString(str) {\n\t            var queryString = str || window.location.search || '';\n\t            var keyValPairs = [];\n\t            var params = {};\n\t            queryString = queryString.replace(/.*?\\?/, \"\");\n\t            if (queryString.length) {\n\t                keyValPairs = queryString.split('&');\n\t                for (var pairNum in keyValPairs) {\n\t                    var key = keyValPairs[pairNum].split('=')[0];\n\t                    if (!key.length)\n\t                        continue;\n\t                    if (typeof params[key] === 'undefined')\n\t                        params[key] = [];\n\t                    params[key].push(keyValPairs[pairNum].split('=')[1]);\n\t                }\n\t            }\n\t            return params;\n\t        }\n\t        var params = parseQueryString(window.location.href);\n\t        var idToken = token(\"#id_token=\");\n\t        var accessToken = token(\"#access_token\");\n\t        if (idToken) {\n\t            if (true) {\n\t                this.decodeIdToken(idToken);\n\t                this.loginCallback && this.loginCallback(null);\n\t            }\n\t            else {\n\t                var error = new Error();\n\t                error.statusText = \"Invalid state\";\n\t                this.loginCallback && this.loginCallback(error);\n\t            }\n\t            return true;\n\t        }\n\t        else if (accessToken) {\n\t            throw \"Should not get here.  This should be handled via the iframe approach.\";\n\t        }\n\t        return false;\n\t    };\n\t    Identity.prototype.decodeIdToken = function (idToken) {\n\t        var _this = this;\n\t        var decodedToken = this.base64Decode(idToken.substring(idToken.indexOf('.') + 1, idToken.lastIndexOf('.')));\n\t        var decodedTokenJSON = JSON.parse(decodedToken);\n\t        var expiryDate = new Date(new Date('01/01/1970 0:0 UTC').getTime() + parseInt(decodedTokenJSON.exp) * 1000);\n\t        this.idToken = new IdToken();\n\t        this.idToken.FullToken = decodedTokenJSON;\n\t        this.idToken.Token = idToken;\n\t        this.idToken.Expiry = expiryDate;\n\t        this.idToken.UPN = decodedTokenJSON.upn;\n\t        this.idToken.TenantId = decodedTokenJSON.tid;\n\t        this.idToken.FamilyName = decodedTokenJSON.family_name;\n\t        this.idToken.GivenName = decodedTokenJSON.given_name;\n\t        this.idToken.Name = decodedTokenJSON.name;\n\t        this.idToken.PreferredUsername = decodedTokenJSON.preferred_username;\n\t        var expiration = expiryDate.getTime() - new Date().getTime() - 300000;\n\t        this.refreshTimer = setTimeout((function () {\n\t            _this.renewIdToken();\n\t        }), expiration);\n\t    };\n\t    Identity.prototype.decodeAccessToken = function (accessToken, resource, scopes) {\n\t        var decodedToken = this.base64Decode(accessToken.substring(accessToken.indexOf('.') + 1, accessToken.lastIndexOf('.')));\n\t        var decodedTokenJSON = JSON.parse(decodedToken);\n\t        var expiryDate = new Date(new Date('01/01/1970 0:0 UTC').getTime() + parseInt(decodedTokenJSON.exp) * 1000);\n\t        var key = resource || scopes.join(\" \");\n\t        var token = new CachedToken(key, scopes, resource, accessToken, expiryDate);\n\t        this.tokenCache.add(token);\n\t    };\n\t    Identity.prototype.getIdToken = function () {\n\t        return this.idToken;\n\t    };\n\t    Identity.prototype.isLoggedIn = function () {\n\t        if (!this.idToken)\n\t            return false;\n\t        return (this.idToken.Expiry > new Date());\n\t    };\n\t    Identity.prototype.renewIdToken = function () {\n\t        clearTimeout(this.refreshTimer);\n\t        this.login(function () { });\n\t    };\n\t    Identity.prototype.getCurrentOauthVersion = function () {\n\t        return this.version;\n\t    };\n\t    Identity.prototype.getAccessTokenAsync = function (resource) {\n\t        var d = new promises_1.Deferred();\n\t        this.getAccessToken(resource, (function (token, error) {\n\t            if (error) {\n\t                d.reject(error);\n\t            }\n\t            else {\n\t                d.resolve(token);\n\t            }\n\t        }));\n\t        return d.promise;\n\t    };\n\t    Identity.prototype.getAccessToken = function (resource, callback) {\n\t        var _this = this;\n\t        if (this.version !== OAuthVersion.v1) {\n\t            var e = new Error();\n\t            e.statusText = \"Currently this identity class is using v2 OAuth mode. You need to use getAccessTokenForScopes() method\";\n\t            callback(null, e);\n\t            return;\n\t        }\n\t        var token = this.tokenCache.getForResource(resource);\n\t        if (token) {\n\t            return callback(token.token, null);\n\t        }\n\t        this.getTokenCallback = (function (token, error) {\n\t            if (error) {\n\t                callback(null, error);\n\t            }\n\t            else {\n\t                _this.decodeAccessToken(token, resource);\n\t                callback(token, null);\n\t            }\n\t        });\n\t        this.nonce = \"token\" + this.generateNonce();\n\t        this.state = \"token\" + this.generateNonce();\n\t        var iframe = document.createElement('iframe');\n\t        iframe.style.display = \"none\";\n\t        iframe.id = \"tokenIFrame\";\n\t        iframe.src = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n\t            \"&resource=\" + encodeURIComponent(resource) +\n\t            \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n\t            \"&state=\" + encodeURIComponent(this.state) +\n\t            \"&version=\" + encodeURIComponent(this.version.toString()) +\n\t            \"&nonce=\" + encodeURIComponent(this.nonce) +\n\t            \"&op=token\";\n\t        document.body.appendChild(iframe);\n\t    };\n\t    Identity.prototype.getAccessTokenForScopesAsync = function (scopes, promptForConsent) {\n\t        if (promptForConsent === void 0) { promptForConsent = false; }\n\t        var d = new promises_1.Deferred();\n\t        this.getAccessTokenForScopes(scopes, promptForConsent, function (token, error) {\n\t            if (error) {\n\t                d.reject(error);\n\t            }\n\t            else {\n\t                d.resolve(token);\n\t            }\n\t        });\n\t        return d.promise;\n\t    };\n\t    Identity.prototype.getAccessTokenForScopes = function (scopes, promptForConsent, callback) {\n\t        var _this = this;\n\t        if (promptForConsent === void 0) { promptForConsent = false; }\n\t        if (this.version !== OAuthVersion.v2) {\n\t            var e = new Error();\n\t            e.statusText = \"Dynamic scopes require v2 mode. Currently this identity class is using v1\";\n\t            callback(null, e);\n\t            return;\n\t        }\n\t        var token = this.tokenCache.getForScopes(scopes);\n\t        if (token) {\n\t            return callback(token.token, null);\n\t        }\n\t        this.getTokenCallback = (function (token, error) {\n\t            if (error) {\n\t                if (promptForConsent || !error.text) {\n\t                    callback(null, error);\n\t                }\n\t                else if (error.text.indexOf(\"AADSTS65001\") >= 0) {\n\t                    _this.getAccessTokenForScopes(scopes, true, _this.getTokenCallback);\n\t                }\n\t                else {\n\t                    callback(null, error);\n\t                }\n\t            }\n\t            else {\n\t                _this.decodeAccessToken(token, null, scopes);\n\t                callback(token, null);\n\t            }\n\t        });\n\t        this.nonce = \"token\" + this.generateNonce();\n\t        this.state = \"token\" + this.generateNonce();\n\t        if (!promptForConsent) {\n\t            var iframe = document.createElement('iframe');\n\t            iframe.style.display = \"none\";\n\t            iframe.id = \"tokenIFrame\";\n\t            iframe.src = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n\t                \"&scopes=\" + encodeURIComponent(scopes.join(\" \")) +\n\t                \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n\t                \"&version=\" + encodeURIComponent(this.version.toString()) +\n\t                \"&state=\" + encodeURIComponent(this.state) +\n\t                \"&nonce=\" + encodeURIComponent(this.nonce) +\n\t                \"&login_hint=\" + encodeURIComponent(this.idToken.PreferredUsername) +\n\t                \"&domain_hint=\" + encodeURIComponent(this.idToken.TenantId === \"9188040d-6c67-4c5b-b112-36a304b66dad\" ? \"consumers\" : \"organizations\") +\n\t                \"&op=token\";\n\t            document.body.appendChild(iframe);\n\t        }\n\t        else {\n\t            window.open(this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n\t                \"&scopes=\" + encodeURIComponent(scopes.join(\" \")) +\n\t                \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n\t                \"&version=\" + encodeURIComponent(this.version.toString()) +\n\t                \"&state=\" + encodeURIComponent(this.state) +\n\t                \"&nonce=\" + encodeURIComponent(this.nonce) +\n\t                \"&op=token\", \"_blank\");\n\t        }\n\t    };\n\t    Identity.prototype.loginAsync = function (loginSettings) {\n\t        var d = new promises_1.Deferred();\n\t        this.login(function (error) {\n\t            if (error) {\n\t                d.reject(error);\n\t            }\n\t            else {\n\t                d.resolve(null);\n\t            }\n\t        }, loginSettings);\n\t        return d.promise;\n\t    };\n\t    Identity.prototype.login = function (callback, loginSettings) {\n\t        this.loginCallback = callback;\n\t        if (!loginSettings)\n\t            loginSettings = {};\n\t        if (loginSettings.policy)\n\t            this.policy = loginSettings.policy;\n\t        if (loginSettings.scopes && this.version === OAuthVersion.v1) {\n\t            var e = new Error();\n\t            e.text = \"Scopes can only be used with OAuth v2.\";\n\t            callback(e);\n\t            return;\n\t        }\n\t        if (loginSettings.policy && !loginSettings.tenant) {\n\t            var e = new Error();\n\t            e.text = \"In order to use policy (AAD B2C) a tenant must be specified as well.\";\n\t            callback(e);\n\t            return;\n\t        }\n\t        this.state = \"login\" + this.generateNonce();\n\t        this.nonce = \"login\" + this.generateNonce();\n\t        var loginURL = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n\t            \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n\t            \"&state=\" + encodeURIComponent(this.state) +\n\t            \"&nonce=\" + encodeURIComponent(this.nonce) +\n\t            \"&version=\" + encodeURIComponent(this.version.toString()) +\n\t            \"&op=login\" +\n\t            \"&p=\" + encodeURIComponent(this.policy);\n\t        if (loginSettings.tenant) {\n\t            loginURL += \"&tenant=\" + encodeURIComponent(loginSettings.tenant);\n\t        }\n\t        if (this.version === OAuthVersion.v2) {\n\t            if (!loginSettings.scopes)\n\t                loginSettings.scopes = [];\n\t            if (loginSettings.scopes.indexOf(\"profile\") < 0)\n\t                loginSettings.scopes.push(\"profile\");\n\t            if (loginSettings.scopes.indexOf(\"openid\") < 0)\n\t                loginSettings.scopes.push(\"openid\");\n\t            loginURL += \"&scopes=\" + encodeURIComponent(loginSettings.scopes.join(\" \"));\n\t        }\n\t        window.open(loginURL, \"_blank\");\n\t    };\n\t    Identity.prototype.loginNoWindowAsync = function (toUrl) {\n\t        var d = new promises_1.Deferred();\n\t        this.loginNoWindow(function (error) {\n\t            if (error) {\n\t                d.reject(error);\n\t            }\n\t            else {\n\t                d.resolve(null);\n\t            }\n\t        }, toUrl);\n\t        return d.promise;\n\t    };\n\t    Identity.prototype.loginNoWindow = function (callback, toUrl) {\n\t        this.loginCallback = callback;\n\t        this.state = \"clientId=\" + this.clientId + \"&\" + \"tokenProcessorUrl=\" + this.tokenProcessorUrl;\n\t        this.nonce = this.generateNonce();\n\t        var redirected = this.checkForIdentityRedirect();\n\t        if (!redirected) {\n\t            var redirectUri = (toUrl) ? toUrl : window.location.href.split(\"#\")[0];\n\t            var url = \"https://login.microsoftonline.com/common/oauth2/authorize?response_type=id_token\" +\n\t                \"&client_id=\" + encodeURIComponent(this.clientId) +\n\t                \"&redirect_uri=\" + encodeURIComponent(redirectUri) +\n\t                \"&state=\" + encodeURIComponent(this.state) +\n\t                \"&nonce=\" + encodeURIComponent(this.nonce);\n\t            window.location.href = url;\n\t        }\n\t    };\n\t    Identity.prototype.logOut = function () {\n\t        this.tokenCache.clear();\n\t        var url = \"https://login.microsoftonline.com/common/oauth2/logout?post_logout_redirect_uri=\" + encodeURI(window.location.href);\n\t        window.location.href = url;\n\t    };\n\t    Identity.prototype.base64Decode = function (encodedString) {\n\t        var e = {}, i, b = 0, c, x, l = 0, a, r = '', w = String.fromCharCode, L = encodedString.length;\n\t        var A = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\t        for (i = 0; i < 64; i++) {\n\t            e[A.charAt(i)] = i;\n\t        }\n\t        for (x = 0; x < L; x++) {\n\t            c = e[encodedString.charAt(x)];\n\t            b = (b << 6) + c;\n\t            l += 6;\n\t            while (l >= 8) {\n\t                ((a = (b >>> (l -= 8)) & 0xff) || (x < (L - 2))) && (r += w(a));\n\t            }\n\t        }\n\t        return r;\n\t    };\n\t    Identity.prototype.generateNonce = function () {\n\t        var text = \"\";\n\t        var chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n\t        for (var i = 0; i < 32; i++) {\n\t            text += chars.charAt(Math.floor(Math.random() * chars.length));\n\t        }\n\t        return text;\n\t    };\n\t    return Identity;\n\t}());\n\texports.Identity = Identity;\n\n\n/***/ }\n/******/ ])\n});\n;\n\n\n/** WEBPACK FOOTER **\n ** dist/kurve.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap c30e60a2eaa9103718e9\n **/","\"use strict\";\nvar graph_1 = require('./graph');\nvar identity_1 = require('./identity');\nmodule.exports = {\n    Graph: graph_1.Graph,\n    Identity: identity_1.Identity\n};\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/index.ts\n ** module id = 0\n ** module chunks = 0\n **/","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar promises_1 = require('./promises');\nvar identity_1 = require('./identity');\nvar Scopes;\n(function (Scopes) {\n    var Util = (function () {\n        function Util() {\n        }\n        Util.rootUrl = \"https://graph.microsoft.com/\";\n        return Util;\n    }());\n    var General = (function () {\n        function General() {\n        }\n        General.OpenId = \"openid\";\n        General.OfflineAccess = \"offline_access\";\n        return General;\n    }());\n    Scopes.General = General;\n    var User = (function () {\n        function User() {\n        }\n        User.Read = Util.rootUrl + \"User.Read\";\n        User.ReadWrite = Util.rootUrl + \"User.ReadWrite\";\n        User.ReadBasicAll = Util.rootUrl + \"User.ReadBasic.All\";\n        User.ReadAll = Util.rootUrl + \"User.Read.All\";\n        User.ReadWriteAll = Util.rootUrl + \"User.ReadWrite.All\";\n        return User;\n    }());\n    Scopes.User = User;\n    var Contacts = (function () {\n        function Contacts() {\n        }\n        Contacts.Read = Util.rootUrl + \"Contacts.Read\";\n        Contacts.ReadWrite = Util.rootUrl + \"Contacts.ReadWrite\";\n        return Contacts;\n    }());\n    Scopes.Contacts = Contacts;\n    var Directory = (function () {\n        function Directory() {\n        }\n        Directory.ReadAll = Util.rootUrl + \"Directory.Read.All\";\n        Directory.ReadWriteAll = Util.rootUrl + \"Directory.ReadWrite.All\";\n        Directory.AccessAsUserAll = Util.rootUrl + \"Directory.AccessAsUser.All\";\n        return Directory;\n    }());\n    Scopes.Directory = Directory;\n    var Group = (function () {\n        function Group() {\n        }\n        Group.ReadAll = Util.rootUrl + \"Group.Read.All\";\n        Group.ReadWriteAll = Util.rootUrl + \"Group.ReadWrite.All\";\n        Group.AccessAsUserAll = Util.rootUrl + \"Directory.AccessAsUser.All\";\n        return Group;\n    }());\n    Scopes.Group = Group;\n    var Mail = (function () {\n        function Mail() {\n        }\n        Mail.Read = Util.rootUrl + \"Mail.Read\";\n        Mail.ReadWrite = Util.rootUrl + \"Mail.ReadWrite\";\n        Mail.Send = Util.rootUrl + \"Mail.Send\";\n        return Mail;\n    }());\n    Scopes.Mail = Mail;\n    var Calendars = (function () {\n        function Calendars() {\n        }\n        Calendars.Read = Util.rootUrl + \"Calendars.Read\";\n        Calendars.ReadWrite = Util.rootUrl + \"Calendars.ReadWrite\";\n        return Calendars;\n    }());\n    Scopes.Calendars = Calendars;\n    var Files = (function () {\n        function Files() {\n        }\n        Files.Read = Util.rootUrl + \"Files.Read\";\n        Files.ReadAll = Util.rootUrl + \"Files.Read.All\";\n        Files.ReadWrite = Util.rootUrl + \"Files.ReadWrite\";\n        Files.ReadWriteAppFolder = Util.rootUrl + \"Files.ReadWrite.AppFolder\";\n        Files.ReadWriteSelected = Util.rootUrl + \"Files.ReadWrite.Selected\";\n        return Files;\n    }());\n    Scopes.Files = Files;\n    var Tasks = (function () {\n        function Tasks() {\n        }\n        Tasks.ReadWrite = Util.rootUrl + \"Tasks.ReadWrite\";\n        return Tasks;\n    }());\n    Scopes.Tasks = Tasks;\n    var People = (function () {\n        function People() {\n        }\n        People.Read = Util.rootUrl + \"People.Read\";\n        People.ReadWrite = Util.rootUrl + \"People.ReadWrite\";\n        return People;\n    }());\n    Scopes.People = People;\n    var Notes = (function () {\n        function Notes() {\n        }\n        Notes.Create = Util.rootUrl + \"Notes.Create\";\n        Notes.ReadWriteCreatedByApp = Util.rootUrl + \"Notes.ReadWrite.CreatedByApp\";\n        Notes.Read = Util.rootUrl + \"Notes.Read\";\n        Notes.ReadAll = Util.rootUrl + \"Notes.Read.All\";\n        Notes.ReadWriteAll = Util.rootUrl + \"Notes.ReadWrite.All\";\n        return Notes;\n    }());\n    Scopes.Notes = Notes;\n})(Scopes = exports.Scopes || (exports.Scopes = {}));\nvar DataModelWrapper = (function () {\n    function DataModelWrapper(graph, _data) {\n        this.graph = graph;\n        this._data = _data;\n    }\n    Object.defineProperty(DataModelWrapper.prototype, \"data\", {\n        get: function () { return this._data; },\n        enumerable: true,\n        configurable: true\n    });\n    return DataModelWrapper;\n}());\nexports.DataModelWrapper = DataModelWrapper;\nvar DataModelListWrapper = (function (_super) {\n    __extends(DataModelListWrapper, _super);\n    function DataModelListWrapper() {\n        _super.apply(this, arguments);\n    }\n    return DataModelListWrapper;\n}(DataModelWrapper));\nexports.DataModelListWrapper = DataModelListWrapper;\nvar ProfilePhotoDataModel = (function () {\n    function ProfilePhotoDataModel() {\n    }\n    return ProfilePhotoDataModel;\n}());\nexports.ProfilePhotoDataModel = ProfilePhotoDataModel;\nvar ProfilePhoto = (function (_super) {\n    __extends(ProfilePhoto, _super);\n    function ProfilePhoto() {\n        _super.apply(this, arguments);\n    }\n    return ProfilePhoto;\n}(DataModelWrapper));\nexports.ProfilePhoto = ProfilePhoto;\nvar UserDataModel = (function () {\n    function UserDataModel() {\n    }\n    return UserDataModel;\n}());\nexports.UserDataModel = UserDataModel;\n(function (EventsEndpoint) {\n    EventsEndpoint[EventsEndpoint[\"events\"] = 0] = \"events\";\n    EventsEndpoint[EventsEndpoint[\"calendarView\"] = 1] = \"calendarView\";\n})(exports.EventsEndpoint || (exports.EventsEndpoint = {}));\nvar EventsEndpoint = exports.EventsEndpoint;\nvar User = (function (_super) {\n    __extends(User, _super);\n    function User() {\n        _super.apply(this, arguments);\n    }\n    User.prototype.events = function (callback, odataQuery) {\n        this.graph.eventsForUser(this._data.userPrincipalName, EventsEndpoint.events, callback, odataQuery);\n    };\n    User.prototype.eventsAsync = function (odataQuery) {\n        return this.graph.eventsForUserAsync(this._data.userPrincipalName, EventsEndpoint.events, odataQuery);\n    };\n    User.prototype.memberOf = function (callback, Error, odataQuery) {\n        this.graph.memberOfForUser(this._data.userPrincipalName, callback, odataQuery);\n    };\n    User.prototype.memberOfAsync = function (odataQuery) {\n        return this.graph.memberOfForUserAsync(this._data.userPrincipalName, odataQuery);\n    };\n    User.prototype.messages = function (callback, odataQuery) {\n        this.graph.messagesForUser(this._data.userPrincipalName, callback, odataQuery);\n    };\n    User.prototype.messagesAsync = function (odataQuery) {\n        return this.graph.messagesForUserAsync(this._data.userPrincipalName, odataQuery);\n    };\n    User.prototype.manager = function (callback, odataQuery) {\n        this.graph.managerForUser(this._data.userPrincipalName, callback, odataQuery);\n    };\n    User.prototype.managerAsync = function (odataQuery) {\n        return this.graph.managerForUserAsync(this._data.userPrincipalName, odataQuery);\n    };\n    User.prototype.profilePhoto = function (callback, odataQuery) {\n        this.graph.profilePhotoForUser(this._data.userPrincipalName, callback, odataQuery);\n    };\n    User.prototype.profilePhotoAsync = function (odataQuery) {\n        return this.graph.profilePhotoForUserAsync(this._data.userPrincipalName, odataQuery);\n    };\n    User.prototype.profilePhotoValue = function (callback, odataQuery) {\n        this.graph.profilePhotoValueForUser(this._data.userPrincipalName, callback, odataQuery);\n    };\n    User.prototype.profilePhotoValueAsync = function (odataQuery) {\n        return this.graph.profilePhotoValueForUserAsync(this._data.userPrincipalName, odataQuery);\n    };\n    User.prototype.calendarView = function (callback, odataQuery) {\n        this.graph.eventsForUser(this._data.userPrincipalName, EventsEndpoint.calendarView, callback, odataQuery);\n    };\n    User.prototype.calendarViewAsync = function (odataQuery) {\n        return this.graph.eventsForUserAsync(this._data.userPrincipalName, EventsEndpoint.calendarView, odataQuery);\n    };\n    User.prototype.mailFolders = function (callback, odataQuery) {\n        this.graph.mailFoldersForUser(this._data.userPrincipalName, callback, odataQuery);\n    };\n    User.prototype.mailFoldersAsync = function (odataQuery) {\n        return this.graph.mailFoldersForUserAsync(this._data.userPrincipalName, odataQuery);\n    };\n    return User;\n}(DataModelWrapper));\nexports.User = User;\nvar Users = (function (_super) {\n    __extends(Users, _super);\n    function Users() {\n        _super.apply(this, arguments);\n    }\n    return Users;\n}(DataModelListWrapper));\nexports.Users = Users;\nvar MessageDataModel = (function () {\n    function MessageDataModel() {\n    }\n    return MessageDataModel;\n}());\nexports.MessageDataModel = MessageDataModel;\nvar Message = (function (_super) {\n    __extends(Message, _super);\n    function Message() {\n        _super.apply(this, arguments);\n    }\n    return Message;\n}(DataModelWrapper));\nexports.Message = Message;\nvar Messages = (function (_super) {\n    __extends(Messages, _super);\n    function Messages() {\n        _super.apply(this, arguments);\n    }\n    return Messages;\n}(DataModelListWrapper));\nexports.Messages = Messages;\nvar EventDataModel = (function () {\n    function EventDataModel() {\n    }\n    return EventDataModel;\n}());\nexports.EventDataModel = EventDataModel;\nvar Event = (function (_super) {\n    __extends(Event, _super);\n    function Event() {\n        _super.apply(this, arguments);\n    }\n    return Event;\n}(DataModelWrapper));\nexports.Event = Event;\nvar Events = (function (_super) {\n    __extends(Events, _super);\n    function Events(graph, endpoint, _data) {\n        _super.call(this, graph, _data);\n        this.graph = graph;\n        this.endpoint = endpoint;\n        this._data = _data;\n    }\n    return Events;\n}(DataModelListWrapper));\nexports.Events = Events;\nvar Contact = (function () {\n    function Contact() {\n    }\n    return Contact;\n}());\nexports.Contact = Contact;\nvar GroupDataModel = (function () {\n    function GroupDataModel() {\n    }\n    return GroupDataModel;\n}());\nexports.GroupDataModel = GroupDataModel;\nvar Group = (function (_super) {\n    __extends(Group, _super);\n    function Group() {\n        _super.apply(this, arguments);\n    }\n    return Group;\n}(DataModelWrapper));\nexports.Group = Group;\nvar Groups = (function (_super) {\n    __extends(Groups, _super);\n    function Groups() {\n        _super.apply(this, arguments);\n    }\n    return Groups;\n}(DataModelListWrapper));\nexports.Groups = Groups;\nvar MailFolderDataModel = (function () {\n    function MailFolderDataModel() {\n    }\n    return MailFolderDataModel;\n}());\nexports.MailFolderDataModel = MailFolderDataModel;\nvar MailFolder = (function (_super) {\n    __extends(MailFolder, _super);\n    function MailFolder() {\n        _super.apply(this, arguments);\n    }\n    return MailFolder;\n}(DataModelWrapper));\nexports.MailFolder = MailFolder;\nvar MailFolders = (function (_super) {\n    __extends(MailFolders, _super);\n    function MailFolders() {\n        _super.apply(this, arguments);\n    }\n    return MailFolders;\n}(DataModelListWrapper));\nexports.MailFolders = MailFolders;\n(function (AttachmentType) {\n    AttachmentType[AttachmentType[\"fileAttachment\"] = 0] = \"fileAttachment\";\n    AttachmentType[AttachmentType[\"itemAttachment\"] = 1] = \"itemAttachment\";\n    AttachmentType[AttachmentType[\"referenceAttachment\"] = 2] = \"referenceAttachment\";\n})(exports.AttachmentType || (exports.AttachmentType = {}));\nvar AttachmentType = exports.AttachmentType;\nvar AttachmentDataModel = (function () {\n    function AttachmentDataModel() {\n    }\n    return AttachmentDataModel;\n}());\nexports.AttachmentDataModel = AttachmentDataModel;\nvar Attachment = (function (_super) {\n    __extends(Attachment, _super);\n    function Attachment() {\n        _super.apply(this, arguments);\n    }\n    Attachment.prototype.getType = function () {\n        switch (this._data['@odata.type']) {\n            case \"#microsoft.graph.fileAttachment\":\n                return AttachmentType.fileAttachment;\n            case \"#microsoft.graph.itemAttachment\":\n                return AttachmentType.itemAttachment;\n            case \"#microsoft.graph.referenceAttachment\":\n                return AttachmentType.referenceAttachment;\n        }\n    };\n    return Attachment;\n}(DataModelWrapper));\nexports.Attachment = Attachment;\nvar Attachments = (function (_super) {\n    __extends(Attachments, _super);\n    function Attachments() {\n        _super.apply(this, arguments);\n    }\n    return Attachments;\n}(DataModelListWrapper));\nexports.Attachments = Attachments;\nvar Graph = (function () {\n    function Graph(identityInfo) {\n        this.req = null;\n        this.accessToken = null;\n        this.KurveIdentity = null;\n        this.defaultResourceID = \"https://graph.microsoft.com\";\n        this.baseUrl = \"https://graph.microsoft.com/v1.0/\";\n        if (identityInfo.defaultAccessToken) {\n            this.accessToken = identityInfo.defaultAccessToken;\n        }\n        else {\n            this.KurveIdentity = identityInfo.identity;\n        }\n    }\n    Graph.prototype.scopesForV2 = function (scopes) {\n        if (!this.KurveIdentity)\n            return null;\n        if (this.KurveIdentity.getCurrentOauthVersion() === identity_1.OAuthVersion.v1)\n            return null;\n        else\n            return scopes;\n    };\n    Graph.prototype.meAsync = function (odataQuery) {\n        var d = new promises_1.Deferred();\n        this.me(function (user, error) { return error ? d.reject(error) : d.resolve(user); }, odataQuery);\n        return d.promise;\n    };\n    Graph.prototype.me = function (callback, odataQuery) {\n        var scopes = [Scopes.User.Read];\n        var urlString = this.buildMeUrl(\"\", odataQuery);\n        this.getUser(urlString, callback, this.scopesForV2(scopes));\n    };\n    Graph.prototype.userAsync = function (userId, odataQuery, basicProfileOnly) {\n        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\n        var d = new promises_1.Deferred();\n        this.user(userId, function (user, error) { return error ? d.reject(error) : d.resolve(user); }, odataQuery, basicProfileOnly);\n        return d.promise;\n    };\n    Graph.prototype.user = function (userId, callback, odataQuery, basicProfileOnly) {\n        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\n        var scopes = basicProfileOnly ? [Scopes.User.ReadBasicAll] : [Scopes.User.ReadAll];\n        var urlString = this.buildUsersUrl(userId, odataQuery);\n        this.getUser(urlString, callback, this.scopesForV2(scopes));\n    };\n    Graph.prototype.usersAsync = function (odataQuery, basicProfileOnly) {\n        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\n        var d = new promises_1.Deferred();\n        this.users(function (users, error) { return error ? d.reject(error) : d.resolve(users); }, odataQuery, basicProfileOnly);\n        return d.promise;\n    };\n    Graph.prototype.users = function (callback, odataQuery, basicProfileOnly) {\n        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\n        var scopes = basicProfileOnly ? [Scopes.User.ReadBasicAll] : [Scopes.User.ReadAll];\n        var urlString = this.buildUsersUrl(\"\", odataQuery);\n        this.getUsers(urlString, callback, this.scopesForV2(scopes), basicProfileOnly);\n    };\n    Graph.prototype.groupAsync = function (groupId, odataQuery) {\n        var d = new promises_1.Deferred();\n        this.group(groupId, function (group, error) { return error ? d.reject(error) : d.resolve(group); }, odataQuery);\n        return d.promise;\n    };\n    Graph.prototype.group = function (groupId, callback, odataQuery) {\n        var scopes = [Scopes.Group.ReadAll];\n        var urlString = this.buildGroupsUrl(groupId, odataQuery);\n        this.getGroup(urlString, callback, this.scopesForV2(scopes));\n    };\n    Graph.prototype.groupsAsync = function (odataQuery) {\n        var d = new promises_1.Deferred();\n        this.groups(function (groups, error) { return error ? d.reject(error) : d.resolve(groups); }, odataQuery);\n        return d.promise;\n    };\n    Graph.prototype.groups = function (callback, odataQuery) {\n        var scopes = [Scopes.Group.ReadAll];\n        var urlString = this.buildGroupsUrl(\"\", odataQuery);\n        this.getGroups(urlString, callback, this.scopesForV2(scopes));\n    };\n    Graph.prototype.messagesForUserAsync = function (userPrincipalName, odataQuery) {\n        var d = new promises_1.Deferred();\n        this.messagesForUser(userPrincipalName, function (messages, error) { return error ? d.reject(error) : d.resolve(messages); }, odataQuery);\n        return d.promise;\n    };\n    Graph.prototype.messagesForUser = function (userPrincipalName, callback, odataQuery) {\n        var scopes = [Scopes.Mail.Read];\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/messages\", odataQuery);\n        this.getMessages(urlString, function (result, error) { return callback(result, error); }, this.scopesForV2(scopes));\n    };\n    Graph.prototype.mailFoldersForUserAsync = function (userPrincipalName, odataQuery) {\n        var d = new promises_1.Deferred();\n        this.mailFoldersForUser(userPrincipalName, function (messages, error) { return error ? d.reject(error) : d.resolve(messages); }, odataQuery);\n        return d.promise;\n    };\n    Graph.prototype.mailFoldersForUser = function (userPrincipalName, callback, odataQuery) {\n        var scopes = [Scopes.Mail.Read];\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/mailFolders\", odataQuery);\n        this.getMailFolders(urlString, function (result, error) { return callback(result, error); }, this.scopesForV2(scopes));\n    };\n    Graph.prototype.eventsForUserAsync = function (userPrincipalName, endpoint, odataQuery) {\n        var d = new promises_1.Deferred();\n        this.eventsForUser(userPrincipalName, endpoint, function (events, error) { return error ? d.reject(error) : d.resolve(events); }, odataQuery);\n        return d.promise;\n    };\n    Graph.prototype.eventsForUser = function (userPrincipalName, endpoint, callback, odataQuery) {\n        var scopes = [Scopes.Calendars.Read];\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/\" + EventsEndpoint[endpoint], odataQuery);\n        this.getEvents(urlString, endpoint, function (result, error) { return callback(result, error); }, this.scopesForV2(scopes));\n    };\n    Graph.prototype.memberOfForUserAsync = function (userPrincipalName, odataQuery) {\n        var d = new promises_1.Deferred();\n        this.memberOfForUser(userPrincipalName, function (groups, error) { return error ? d.reject(error) : d.resolve(groups); }, odataQuery);\n        return d.promise;\n    };\n    Graph.prototype.memberOfForUser = function (userPrincipalName, callback, odataQuery) {\n        var scopes = [Scopes.Group.ReadAll];\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/memberOf\", odataQuery);\n        this.getGroups(urlString, callback, this.scopesForV2(scopes));\n    };\n    Graph.prototype.managerForUserAsync = function (userPrincipalName, odataQuery) {\n        var d = new promises_1.Deferred();\n        this.managerForUser(userPrincipalName, function (user, error) { return error ? d.reject(error) : d.resolve(user); }, odataQuery);\n        return d.promise;\n    };\n    Graph.prototype.managerForUser = function (userPrincipalName, callback, odataQuery) {\n        var scopes = [Scopes.Directory.ReadAll];\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/manager\", odataQuery);\n        this.getUser(urlString, callback, this.scopesForV2(scopes));\n    };\n    Graph.prototype.directReportsForUserAsync = function (userPrincipalName, odataQuery) {\n        var d = new promises_1.Deferred();\n        this.directReportsForUser(userPrincipalName, function (users, error) { return error ? d.reject(error) : d.resolve(users); }, odataQuery);\n        return d.promise;\n    };\n    Graph.prototype.directReportsForUser = function (userPrincipalName, callback, odataQuery) {\n        var scopes = [Scopes.Directory.ReadAll];\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/directReports\", odataQuery);\n        this.getUsers(urlString, callback, this.scopesForV2(scopes));\n    };\n    Graph.prototype.profilePhotoForUserAsync = function (userPrincipalName, odataQuery) {\n        var d = new promises_1.Deferred();\n        this.profilePhotoForUser(userPrincipalName, function (profilePhoto, error) { return error ? d.reject(error) : d.resolve(profilePhoto); }, odataQuery);\n        return d.promise;\n    };\n    Graph.prototype.profilePhotoForUser = function (userPrincipalName, callback, odataQuery) {\n        var scopes = [Scopes.User.ReadBasicAll];\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/photo\", odataQuery);\n        this.getPhoto(urlString, callback, this.scopesForV2(scopes));\n    };\n    Graph.prototype.profilePhotoValueForUserAsync = function (userPrincipalName, odataQuery) {\n        var d = new promises_1.Deferred();\n        this.profilePhotoValueForUser(userPrincipalName, function (result, error) { return error ? d.reject(error) : d.resolve(result); }, odataQuery);\n        return d.promise;\n    };\n    Graph.prototype.profilePhotoValueForUser = function (userPrincipalName, callback, odataQuery) {\n        var scopes = [Scopes.User.ReadBasicAll];\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/photo/$value\", odataQuery);\n        this.getPhotoValue(urlString, callback, this.scopesForV2(scopes));\n    };\n    Graph.prototype.messageAttachmentsForUserAsync = function (userPrincipalName, messageId, odataQuery) {\n        var d = new promises_1.Deferred();\n        this.messageAttachmentsForUser(userPrincipalName, messageId, function (result, error) { return error ? d.reject(error) : d.resolve(result); }, odataQuery);\n        return d.promise;\n    };\n    Graph.prototype.messageAttachmentsForUser = function (userPrincipalName, messageId, callback, odataQuery) {\n        var scopes = [Scopes.Mail.Read];\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/messages/\" + messageId + \"/attachments\", odataQuery);\n        this.getMessageAttachments(urlString, callback, this.scopesForV2(scopes));\n    };\n    Graph.prototype.messageAttachmentForUserAsync = function (userPrincipalName, messageId, attachmentId, odataQuery) {\n        var d = new promises_1.Deferred();\n        this.messageAttachmentForUser(userPrincipalName, messageId, attachmentId, function (attachment, error) { return error ? d.reject(error) : d.resolve(attachment); }, odataQuery);\n        return d.promise;\n    };\n    Graph.prototype.messageAttachmentForUser = function (userPrincipalName, messageId, attachmentId, callback, odataQuery) {\n        var scopes = [Scopes.Mail.Read];\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/messages/\" + messageId + \"/attachments/\" + attachmentId, odataQuery);\n        this.getMessageAttachment(urlString, callback, this.scopesForV2(scopes));\n    };\n    Graph.prototype.getAsync = function (url) {\n        var d = new promises_1.Deferred();\n        this.get(url, function (response, error) { return error ? d.reject(error) : d.resolve(response); });\n        return d.promise;\n    };\n    Graph.prototype.get = function (url, callback, responseType, scopes) {\n        var _this = this;\n        var xhr = new XMLHttpRequest();\n        if (responseType)\n            xhr.responseType = responseType;\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState === 4)\n                if (xhr.status === 200)\n                    callback(responseType ? xhr.response : xhr.responseText, null);\n                else\n                    callback(null, _this.generateError(xhr));\n        };\n        xhr.open(\"GET\", url);\n        this.addAccessTokenAndSend(xhr, function (addTokenError) {\n            if (addTokenError) {\n                callback(null, addTokenError);\n            }\n        }, scopes);\n    };\n    Graph.prototype.generateError = function (xhr) {\n        var response = new identity_1.Error();\n        response.status = xhr.status;\n        response.statusText = xhr.statusText;\n        if (xhr.responseType === '' || xhr.responseType === 'text')\n            response.text = xhr.responseText;\n        else\n            response.other = xhr.response;\n        return response;\n    };\n    Graph.prototype.getUsers = function (urlString, callback, scopes, basicProfileOnly) {\n        var _this = this;\n        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\n        this.get(urlString, function (result, errorGet) {\n            if (errorGet) {\n                callback(null, errorGet);\n                return;\n            }\n            var usersODATA = JSON.parse(result);\n            if (usersODATA.error) {\n                var errorODATA = new identity_1.Error();\n                errorODATA.other = usersODATA.error;\n                callback(null, errorODATA);\n                return;\n            }\n            var resultsArray = (usersODATA.value ? usersODATA.value : [usersODATA]);\n            var users = new Users(_this, resultsArray.map(function (o) { return new User(_this, o); }));\n            var nextLink = usersODATA['@odata.nextLink'];\n            if (nextLink) {\n                users.nextLink = function (callback) {\n                    var scopes = basicProfileOnly ? [Scopes.User.ReadBasicAll] : [Scopes.User.ReadAll];\n                    var d = new promises_1.Deferred();\n                    _this.getUsers(nextLink, function (result, error) {\n                        if (callback)\n                            callback(result, error);\n                        else\n                            error ? d.reject(error) : d.resolve(result);\n                    }, _this.scopesForV2(scopes), basicProfileOnly);\n                    return d.promise;\n                };\n            }\n            callback(users, null);\n        }, null, scopes);\n    };\n    Graph.prototype.getUser = function (urlString, callback, scopes) {\n        var _this = this;\n        this.get(urlString, function (result, errorGet) {\n            if (errorGet) {\n                callback(null, errorGet);\n                return;\n            }\n            var userODATA = JSON.parse(result);\n            if (userODATA.error) {\n                var errorODATA = new identity_1.Error();\n                errorODATA.other = userODATA.error;\n                callback(null, errorODATA);\n                return;\n            }\n            var user = new User(_this, userODATA);\n            callback(user, null);\n        }, null, scopes);\n    };\n    Graph.prototype.addAccessTokenAndSend = function (xhr, callback, scopes) {\n        if (this.accessToken) {\n            xhr.setRequestHeader('Authorization', 'Bearer ' + this.accessToken);\n            xhr.send();\n        }\n        else {\n            if (scopes) {\n                this.KurveIdentity.getAccessTokenForScopes(scopes, false, (function (token, error) {\n                    if (error)\n                        callback(error);\n                    else {\n                        xhr.setRequestHeader('Authorization', 'Bearer ' + token);\n                        xhr.send();\n                        callback(null);\n                    }\n                }));\n            }\n            else {\n                this.KurveIdentity.getAccessToken(this.defaultResourceID, (function (token, error) {\n                    if (error)\n                        callback(error);\n                    else {\n                        xhr.setRequestHeader('Authorization', 'Bearer ' + token);\n                        xhr.send();\n                        callback(null);\n                    }\n                }));\n            }\n        }\n    };\n    Graph.prototype.getMessages = function (urlString, callback, scopes) {\n        var _this = this;\n        this.get(urlString, function (result, errorGet) {\n            if (errorGet) {\n                callback(null, errorGet);\n                return;\n            }\n            var messagesODATA = JSON.parse(result);\n            if (messagesODATA.error) {\n                var errorODATA = new identity_1.Error();\n                errorODATA.other = messagesODATA.error;\n                callback(null, errorODATA);\n                return;\n            }\n            var resultsArray = (messagesODATA.value ? messagesODATA.value : [messagesODATA]);\n            var messages = new Messages(_this, resultsArray.map(function (o) { return new Message(_this, o); }));\n            var nextLink = messagesODATA['@odata.nextLink'];\n            if (nextLink) {\n                messages.nextLink = function (callback) {\n                    var scopes = [Scopes.Mail.Read];\n                    var d = new promises_1.Deferred();\n                    _this.getMessages(nextLink, function (messages, error) {\n                        if (callback)\n                            callback(messages, error);\n                        else\n                            error ? d.reject(error) : d.resolve(messages);\n                    }, _this.scopesForV2(scopes));\n                    return d.promise;\n                };\n            }\n            callback(messages, null);\n        }, null, scopes);\n    };\n    Graph.prototype.getEvents = function (urlString, endpoint, callback, scopes) {\n        var _this = this;\n        this.get(urlString, function (result, errorGet) {\n            if (errorGet) {\n                callback(null, errorGet);\n                return;\n            }\n            var odata = JSON.parse(result);\n            if (odata.error) {\n                var errorODATA = new identity_1.Error();\n                errorODATA.other = odata.error;\n                callback(null, errorODATA);\n                return;\n            }\n            var resultsArray = (odata.value ? odata.value : [odata]);\n            var events = new Events(_this, endpoint, resultsArray.map(function (o) { return new Event(_this, o); }));\n            var nextLink = odata['@odata.nextLink'];\n            if (nextLink) {\n                events.nextLink = function (callback) {\n                    var scopes = [Scopes.Mail.Read];\n                    var d = new promises_1.Deferred();\n                    _this.getEvents(nextLink, endpoint, function (result, error) {\n                        if (callback)\n                            callback(result, error);\n                        else\n                            error ? d.reject(error) : d.resolve(result);\n                    }, _this.scopesForV2(scopes));\n                    return d.promise;\n                };\n            }\n            callback(events, null);\n        }, null, scopes);\n    };\n    Graph.prototype.getGroups = function (urlString, callback, scopes) {\n        var _this = this;\n        this.get(urlString, function (result, errorGet) {\n            if (errorGet) {\n                callback(null, errorGet);\n                return;\n            }\n            var groupsODATA = JSON.parse(result);\n            if (groupsODATA.error) {\n                var errorODATA = new identity_1.Error();\n                errorODATA.other = groupsODATA.error;\n                callback(null, errorODATA);\n                return;\n            }\n            var resultsArray = (groupsODATA.value ? groupsODATA.value : [groupsODATA]);\n            var groups = new Groups(_this, resultsArray.map(function (o) { return new Group(_this, o); }));\n            var nextLink = groupsODATA['@odata.nextLink'];\n            if (nextLink) {\n                groups.nextLink = function (callback) {\n                    var scopes = [Scopes.Group.ReadAll];\n                    var d = new promises_1.Deferred();\n                    _this.getGroups(nextLink, function (result, error) {\n                        if (callback)\n                            callback(result, error);\n                        else\n                            error ? d.reject(error) : d.resolve(result);\n                    }, _this.scopesForV2(scopes));\n                    return d.promise;\n                };\n            }\n            callback(groups, null);\n        }, null, scopes);\n    };\n    Graph.prototype.getGroup = function (urlString, callback, scopes) {\n        var _this = this;\n        this.get(urlString, function (result, errorGet) {\n            if (errorGet) {\n                callback(null, errorGet);\n                return;\n            }\n            var ODATA = JSON.parse(result);\n            if (ODATA.error) {\n                var ODATAError = new identity_1.Error();\n                ODATAError.other = ODATA.error;\n                callback(null, ODATAError);\n                return;\n            }\n            var group = new Group(_this, ODATA);\n            callback(group, null);\n        }, null, scopes);\n    };\n    Graph.prototype.getPhoto = function (urlString, callback, scopes) {\n        var _this = this;\n        this.get(urlString, function (result, errorGet) {\n            if (errorGet) {\n                callback(null, errorGet);\n                return;\n            }\n            var ODATA = JSON.parse(result);\n            if (ODATA.error) {\n                var errorODATA = new identity_1.Error();\n                errorODATA.other = ODATA.error;\n                callback(null, errorODATA);\n                return;\n            }\n            var photo = new ProfilePhoto(_this, ODATA);\n            callback(photo, null);\n        }, null, scopes);\n    };\n    Graph.prototype.getPhotoValue = function (urlString, callback, scopes) {\n        this.get(urlString, function (result, errorGet) {\n            if (errorGet) {\n                callback(null, errorGet);\n                return;\n            }\n            callback(result, null);\n        }, \"blob\", scopes);\n    };\n    Graph.prototype.getMailFolders = function (urlString, callback, scopes) {\n        var _this = this;\n        this.get(urlString, function (result, errorGet) {\n            if (errorGet) {\n                callback(null, errorGet);\n                return;\n            }\n            var odata = JSON.parse(result);\n            if (odata.error) {\n                var errorODATA = new identity_1.Error();\n                errorODATA.other = odata.error;\n                callback(null, errorODATA);\n            }\n            var resultsArray = (odata.value ? odata.value : [odata]);\n            var mailFolders = new MailFolders(_this, resultsArray.map(function (o) { return new MailFolder(_this, o); }));\n            var nextLink = odata['@odata.nextLink'];\n            if (nextLink) {\n                mailFolders.nextLink = function (callback) {\n                    var scopes = [Scopes.User.ReadAll];\n                    var d = new promises_1.Deferred();\n                    _this.getMailFolders(nextLink, function (result, error) {\n                        if (callback)\n                            callback(result, error);\n                        else\n                            error ? d.reject(error) : d.resolve(result);\n                    }, _this.scopesForV2(scopes));\n                    return d.promise;\n                };\n            }\n            callback(mailFolders, null);\n        }, null, scopes);\n    };\n    Graph.prototype.getMessageAttachments = function (urlString, callback, scopes) {\n        var _this = this;\n        this.get(urlString, function (result, errorGet) {\n            if (errorGet) {\n                callback(null, errorGet);\n                return;\n            }\n            var attachmentsODATA = JSON.parse(result);\n            if (attachmentsODATA.error) {\n                var errorODATA = new identity_1.Error();\n                errorODATA.other = attachmentsODATA.error;\n                callback(null, errorODATA);\n                return;\n            }\n            var resultsArray = (attachmentsODATA.value ? attachmentsODATA.value : [attachmentsODATA]);\n            var attachments = new Attachments(_this, resultsArray.map(function (o) { return new Attachment(_this, o); }));\n            var nextLink = attachmentsODATA['@odata.nextLink'];\n            if (nextLink) {\n                attachments.nextLink = function (callback) {\n                    var scopes = [Scopes.Mail.Read];\n                    var d = new promises_1.Deferred();\n                    _this.getMessageAttachments(nextLink, function (attachments, error) {\n                        if (callback)\n                            callback(attachments, error);\n                        else\n                            error ? d.reject(error) : d.resolve(attachments);\n                    }, _this.scopesForV2(scopes));\n                    return d.promise;\n                };\n            }\n            callback(attachments, null);\n        }, null, scopes);\n    };\n    Graph.prototype.getMessageAttachment = function (urlString, callback, scopes) {\n        var _this = this;\n        this.get(urlString, function (result, errorGet) {\n            if (errorGet) {\n                callback(null, errorGet);\n                return;\n            }\n            var ODATA = JSON.parse(result);\n            if (ODATA.error) {\n                var ODATAError = new identity_1.Error();\n                ODATAError.other = ODATA.error;\n                callback(null, ODATAError);\n                return;\n            }\n            var attachment = new Attachment(_this, ODATA);\n            callback(attachment, null);\n        }, null, scopes);\n    };\n    Graph.prototype.buildUrl = function (root, path, odataQuery) {\n        return this.baseUrl + root + path + (odataQuery ? \"?\" + odataQuery : \"\");\n    };\n    Graph.prototype.buildMeUrl = function (path, odataQuery) {\n        if (path === void 0) { path = \"\"; }\n        return this.buildUrl(\"me/\", path, odataQuery);\n    };\n    Graph.prototype.buildUsersUrl = function (path, odataQuery) {\n        if (path === void 0) { path = \"\"; }\n        return this.buildUrl(\"users/\", path, odataQuery);\n    };\n    Graph.prototype.buildGroupsUrl = function (path, odataQuery) {\n        if (path === void 0) { path = \"\"; }\n        return this.buildUrl(\"groups/\", path, odataQuery);\n    };\n    return Graph;\n}());\nexports.Graph = Graph;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/graph.ts\n ** module id = 1\n ** module chunks = 0\n **/","\"use strict\";\nfunction DispatchDeferred(closure) {\n    setTimeout(closure, 0);\n}\nvar PromiseState;\n(function (PromiseState) {\n    PromiseState[PromiseState[\"Pending\"] = 0] = \"Pending\";\n    PromiseState[PromiseState[\"ResolutionInProgress\"] = 1] = \"ResolutionInProgress\";\n    PromiseState[PromiseState[\"Resolved\"] = 2] = \"Resolved\";\n    PromiseState[PromiseState[\"Rejected\"] = 3] = \"Rejected\";\n})(PromiseState || (PromiseState = {}));\nvar Client = (function () {\n    function Client(_dispatcher, _successCB, _errorCB) {\n        this._dispatcher = _dispatcher;\n        this._successCB = _successCB;\n        this._errorCB = _errorCB;\n        this.result = new Deferred(_dispatcher);\n    }\n    Client.prototype.resolve = function (value, defer) {\n        var _this = this;\n        if (typeof (this._successCB) !== 'function') {\n            this.result.resolve(value);\n            return;\n        }\n        if (defer) {\n            this._dispatcher(function () { return _this._dispatchCallback(_this._successCB, value); });\n        }\n        else {\n            this._dispatchCallback(this._successCB, value);\n        }\n    };\n    Client.prototype.reject = function (error, defer) {\n        var _this = this;\n        if (typeof (this._errorCB) !== 'function') {\n            this.result.reject(error);\n            return;\n        }\n        if (defer) {\n            this._dispatcher(function () { return _this._dispatchCallback(_this._errorCB, error); });\n        }\n        else {\n            this._dispatchCallback(this._errorCB, error);\n        }\n    };\n    Client.prototype._dispatchCallback = function (callback, arg) {\n        var result, then, type;\n        try {\n            result = callback(arg);\n            this.result.resolve(result);\n        }\n        catch (err) {\n            this.result.reject(err);\n            return;\n        }\n    };\n    return Client;\n}());\nvar Deferred = (function () {\n    function Deferred(dispatcher) {\n        this._stack = [];\n        this._state = PromiseState.Pending;\n        if (dispatcher)\n            this._dispatcher = dispatcher;\n        else\n            this._dispatcher = DispatchDeferred;\n        this.promise = new Promise(this);\n    }\n    Deferred.prototype.DispatchDeferred = function (closure) {\n        setTimeout(closure, 0);\n    };\n    Deferred.prototype.then = function (successCB, errorCB) {\n        if (typeof (successCB) !== 'function' && typeof (errorCB) !== 'function') {\n            return this.promise;\n        }\n        var client = new Client(this._dispatcher, successCB, errorCB);\n        switch (this._state) {\n            case PromiseState.Pending:\n            case PromiseState.ResolutionInProgress:\n                this._stack.push(client);\n                break;\n            case PromiseState.Resolved:\n                client.resolve(this._value, true);\n                break;\n            case PromiseState.Rejected:\n                client.reject(this._error, true);\n                break;\n        }\n        return client.result.promise;\n    };\n    Deferred.prototype.resolve = function (value) {\n        if (this._state !== PromiseState.Pending) {\n            return this;\n        }\n        return this._resolve(value);\n    };\n    Deferred.prototype._resolve = function (value) {\n        var _this = this;\n        var type = typeof (value), then, pending = true;\n        try {\n            if (value !== null &&\n                (type === 'object' || type === 'function') &&\n                typeof (then = value.then) === 'function') {\n                if (value === this.promise) {\n                    throw new TypeError('recursive resolution');\n                }\n                this._state = PromiseState.ResolutionInProgress;\n                then.call(value, function (result) {\n                    if (pending) {\n                        pending = false;\n                        _this._resolve(result);\n                    }\n                }, function (error) {\n                    if (pending) {\n                        pending = false;\n                        _this._reject(error);\n                    }\n                });\n            }\n            else {\n                this._state = PromiseState.ResolutionInProgress;\n                this._dispatcher(function () {\n                    _this._state = PromiseState.Resolved;\n                    _this._value = value;\n                    var i, stackSize = _this._stack.length;\n                    for (i = 0; i < stackSize; i++) {\n                        _this._stack[i].resolve(value, false);\n                    }\n                    _this._stack.splice(0, stackSize);\n                });\n            }\n        }\n        catch (err) {\n            if (pending) {\n                this._reject(err);\n            }\n        }\n        return this;\n    };\n    Deferred.prototype.reject = function (error) {\n        if (this._state !== PromiseState.Pending) {\n            return this;\n        }\n        return this._reject(error);\n    };\n    Deferred.prototype._reject = function (error) {\n        var _this = this;\n        this._state = PromiseState.ResolutionInProgress;\n        this._dispatcher(function () {\n            _this._state = PromiseState.Rejected;\n            _this._error = error;\n            var stackSize = _this._stack.length, i = 0;\n            for (i = 0; i < stackSize; i++) {\n                _this._stack[i].reject(error, false);\n            }\n            _this._stack.splice(0, stackSize);\n        });\n        return this;\n    };\n    return Deferred;\n}());\nexports.Deferred = Deferred;\nvar Promise = (function () {\n    function Promise(_deferred) {\n        this._deferred = _deferred;\n    }\n    Promise.prototype.then = function (successCallback, errorCallback) {\n        return this._deferred.then(successCallback, errorCallback);\n    };\n    Promise.prototype.fail = function (errorCallback) {\n        return this._deferred.then(undefined, errorCallback);\n    };\n    return Promise;\n}());\nexports.Promise = Promise;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/promises.ts\n ** module id = 2\n ** module chunks = 0\n **/","\"use strict\";\nvar promises_1 = require('./promises');\n(function (OAuthVersion) {\n    OAuthVersion[OAuthVersion[\"v1\"] = 1] = \"v1\";\n    OAuthVersion[OAuthVersion[\"v2\"] = 2] = \"v2\";\n})(exports.OAuthVersion || (exports.OAuthVersion = {}));\nvar OAuthVersion = exports.OAuthVersion;\nvar Error = (function () {\n    function Error() {\n    }\n    return Error;\n}());\nexports.Error = Error;\nvar CachedToken = (function () {\n    function CachedToken(id, scopes, resource, token, expiry) {\n        this.id = id;\n        this.scopes = scopes;\n        this.resource = resource;\n        this.token = token;\n        this.expiry = expiry;\n    }\n    ;\n    Object.defineProperty(CachedToken.prototype, \"isExpired\", {\n        get: function () {\n            return this.expiry <= new Date(new Date().getTime() + 60000);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    CachedToken.prototype.hasScopes = function (requiredScopes) {\n        var _this = this;\n        if (!this.scopes) {\n            return false;\n        }\n        return requiredScopes.every(function (requiredScope) {\n            return _this.scopes.some(function (actualScope) { return requiredScope === actualScope; });\n        });\n    };\n    return CachedToken;\n}());\nvar TokenCache = (function () {\n    function TokenCache(tokenStorage) {\n        var _this = this;\n        this.tokenStorage = tokenStorage;\n        this.cachedTokens = {};\n        if (tokenStorage) {\n            tokenStorage.getAll().forEach(function (_a) {\n                var id = _a.id, scopes = _a.scopes, resource = _a.resource, token = _a.token, expiry = _a.expiry;\n                var cachedToken = new CachedToken(id, scopes, resource, token, new Date(expiry));\n                if (cachedToken.isExpired) {\n                    _this.tokenStorage.remove(cachedToken.id);\n                }\n                else {\n                    _this.cachedTokens[cachedToken.id] = cachedToken;\n                }\n            });\n        }\n    }\n    TokenCache.prototype.add = function (token) {\n        this.cachedTokens[token.id] = token;\n        this.tokenStorage && this.tokenStorage.add(token.id, token);\n    };\n    TokenCache.prototype.getForResource = function (resource) {\n        var cachedToken = this.cachedTokens[resource];\n        if (cachedToken && cachedToken.isExpired) {\n            this.remove(resource);\n            return null;\n        }\n        return cachedToken;\n    };\n    TokenCache.prototype.getForScopes = function (scopes) {\n        for (var key in this.cachedTokens) {\n            var cachedToken = this.cachedTokens[key];\n            if (cachedToken.hasScopes(scopes)) {\n                if (cachedToken.isExpired) {\n                    this.remove(key);\n                }\n                else {\n                    return cachedToken;\n                }\n            }\n        }\n        return null;\n    };\n    TokenCache.prototype.clear = function () {\n        this.cachedTokens = {};\n        this.tokenStorage && this.tokenStorage.clear();\n    };\n    TokenCache.prototype.remove = function (key) {\n        this.tokenStorage && this.tokenStorage.remove(key);\n        delete this.cachedTokens[key];\n    };\n    return TokenCache;\n}());\nvar IdToken = (function () {\n    function IdToken() {\n    }\n    return IdToken;\n}());\nexports.IdToken = IdToken;\nvar Identity = (function () {\n    function Identity(identitySettings) {\n        var _this = this;\n        this.policy = \"\";\n        this.clientId = identitySettings.clientId;\n        this.tokenProcessorUrl = identitySettings.tokenProcessingUri;\n        if (identitySettings.version)\n            this.version = identitySettings.version;\n        else\n            this.version = OAuthVersion.v1;\n        this.tokenCache = new TokenCache(identitySettings.tokenStorage);\n        window.addEventListener(\"message\", function (event) {\n            if (event.data.type === \"id_token\") {\n                if (event.data.error) {\n                    var e = new Error();\n                    e.text = event.data.error;\n                    _this.loginCallback(e);\n                }\n                else {\n                    if (_this.state !== event.data.state) {\n                        var error = new Error();\n                        error.statusText = \"Invalid state\";\n                        _this.loginCallback(error);\n                    }\n                    else {\n                        _this.decodeIdToken(event.data.token);\n                        _this.loginCallback(null);\n                    }\n                }\n            }\n            else if (event.data.type === \"access_token\") {\n                if (event.data.error) {\n                    var e = new Error();\n                    e.text = event.data.error;\n                    _this.getTokenCallback(null, e);\n                }\n                else {\n                    var token = event.data.token;\n                    var iframe = document.getElementById(\"tokenIFrame\");\n                    iframe.parentNode.removeChild(iframe);\n                    if (event.data.state !== _this.state) {\n                        var error = new Error();\n                        error.statusText = \"Invalid state\";\n                        _this.getTokenCallback(null, error);\n                    }\n                    else {\n                        _this.getTokenCallback(token, null);\n                    }\n                }\n            }\n        });\n    }\n    Identity.prototype.checkForIdentityRedirect = function () {\n        function token(s) {\n            var start = window.location.href.indexOf(s);\n            if (start < 0)\n                return null;\n            var end = window.location.href.indexOf(\"&\", start + s.length);\n            return window.location.href.substring(start, ((end > 0) ? end : window.location.href.length));\n        }\n        function parseQueryString(str) {\n            var queryString = str || window.location.search || '';\n            var keyValPairs = [];\n            var params = {};\n            queryString = queryString.replace(/.*?\\?/, \"\");\n            if (queryString.length) {\n                keyValPairs = queryString.split('&');\n                for (var pairNum in keyValPairs) {\n                    var key = keyValPairs[pairNum].split('=')[0];\n                    if (!key.length)\n                        continue;\n                    if (typeof params[key] === 'undefined')\n                        params[key] = [];\n                    params[key].push(keyValPairs[pairNum].split('=')[1]);\n                }\n            }\n            return params;\n        }\n        var params = parseQueryString(window.location.href);\n        var idToken = token(\"#id_token=\");\n        var accessToken = token(\"#access_token\");\n        if (idToken) {\n            if (true || this.state === params[\"state\"][0]) {\n                this.decodeIdToken(idToken);\n                this.loginCallback && this.loginCallback(null);\n            }\n            else {\n                var error = new Error();\n                error.statusText = \"Invalid state\";\n                this.loginCallback && this.loginCallback(error);\n            }\n            return true;\n        }\n        else if (accessToken) {\n            throw \"Should not get here.  This should be handled via the iframe approach.\";\n        }\n        return false;\n    };\n    Identity.prototype.decodeIdToken = function (idToken) {\n        var _this = this;\n        var decodedToken = this.base64Decode(idToken.substring(idToken.indexOf('.') + 1, idToken.lastIndexOf('.')));\n        var decodedTokenJSON = JSON.parse(decodedToken);\n        var expiryDate = new Date(new Date('01/01/1970 0:0 UTC').getTime() + parseInt(decodedTokenJSON.exp) * 1000);\n        this.idToken = new IdToken();\n        this.idToken.FullToken = decodedTokenJSON;\n        this.idToken.Token = idToken;\n        this.idToken.Expiry = expiryDate;\n        this.idToken.UPN = decodedTokenJSON.upn;\n        this.idToken.TenantId = decodedTokenJSON.tid;\n        this.idToken.FamilyName = decodedTokenJSON.family_name;\n        this.idToken.GivenName = decodedTokenJSON.given_name;\n        this.idToken.Name = decodedTokenJSON.name;\n        this.idToken.PreferredUsername = decodedTokenJSON.preferred_username;\n        var expiration = expiryDate.getTime() - new Date().getTime() - 300000;\n        this.refreshTimer = setTimeout((function () {\n            _this.renewIdToken();\n        }), expiration);\n    };\n    Identity.prototype.decodeAccessToken = function (accessToken, resource, scopes) {\n        var decodedToken = this.base64Decode(accessToken.substring(accessToken.indexOf('.') + 1, accessToken.lastIndexOf('.')));\n        var decodedTokenJSON = JSON.parse(decodedToken);\n        var expiryDate = new Date(new Date('01/01/1970 0:0 UTC').getTime() + parseInt(decodedTokenJSON.exp) * 1000);\n        var key = resource || scopes.join(\" \");\n        var token = new CachedToken(key, scopes, resource, accessToken, expiryDate);\n        this.tokenCache.add(token);\n    };\n    Identity.prototype.getIdToken = function () {\n        return this.idToken;\n    };\n    Identity.prototype.isLoggedIn = function () {\n        if (!this.idToken)\n            return false;\n        return (this.idToken.Expiry > new Date());\n    };\n    Identity.prototype.renewIdToken = function () {\n        clearTimeout(this.refreshTimer);\n        this.login(function () { });\n    };\n    Identity.prototype.getCurrentOauthVersion = function () {\n        return this.version;\n    };\n    Identity.prototype.getAccessTokenAsync = function (resource) {\n        var d = new promises_1.Deferred();\n        this.getAccessToken(resource, (function (token, error) {\n            if (error) {\n                d.reject(error);\n            }\n            else {\n                d.resolve(token);\n            }\n        }));\n        return d.promise;\n    };\n    Identity.prototype.getAccessToken = function (resource, callback) {\n        var _this = this;\n        if (this.version !== OAuthVersion.v1) {\n            var e = new Error();\n            e.statusText = \"Currently this identity class is using v2 OAuth mode. You need to use getAccessTokenForScopes() method\";\n            callback(null, e);\n            return;\n        }\n        var token = this.tokenCache.getForResource(resource);\n        if (token) {\n            return callback(token.token, null);\n        }\n        this.getTokenCallback = (function (token, error) {\n            if (error) {\n                callback(null, error);\n            }\n            else {\n                _this.decodeAccessToken(token, resource);\n                callback(token, null);\n            }\n        });\n        this.nonce = \"token\" + this.generateNonce();\n        this.state = \"token\" + this.generateNonce();\n        var iframe = document.createElement('iframe');\n        iframe.style.display = \"none\";\n        iframe.id = \"tokenIFrame\";\n        iframe.src = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n            \"&resource=\" + encodeURIComponent(resource) +\n            \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n            \"&state=\" + encodeURIComponent(this.state) +\n            \"&version=\" + encodeURIComponent(this.version.toString()) +\n            \"&nonce=\" + encodeURIComponent(this.nonce) +\n            \"&op=token\";\n        document.body.appendChild(iframe);\n    };\n    Identity.prototype.getAccessTokenForScopesAsync = function (scopes, promptForConsent) {\n        if (promptForConsent === void 0) { promptForConsent = false; }\n        var d = new promises_1.Deferred();\n        this.getAccessTokenForScopes(scopes, promptForConsent, function (token, error) {\n            if (error) {\n                d.reject(error);\n            }\n            else {\n                d.resolve(token);\n            }\n        });\n        return d.promise;\n    };\n    Identity.prototype.getAccessTokenForScopes = function (scopes, promptForConsent, callback) {\n        var _this = this;\n        if (promptForConsent === void 0) { promptForConsent = false; }\n        if (this.version !== OAuthVersion.v2) {\n            var e = new Error();\n            e.statusText = \"Dynamic scopes require v2 mode. Currently this identity class is using v1\";\n            callback(null, e);\n            return;\n        }\n        var token = this.tokenCache.getForScopes(scopes);\n        if (token) {\n            return callback(token.token, null);\n        }\n        this.getTokenCallback = (function (token, error) {\n            if (error) {\n                if (promptForConsent || !error.text) {\n                    callback(null, error);\n                }\n                else if (error.text.indexOf(\"AADSTS65001\") >= 0) {\n                    _this.getAccessTokenForScopes(scopes, true, _this.getTokenCallback);\n                }\n                else {\n                    callback(null, error);\n                }\n            }\n            else {\n                _this.decodeAccessToken(token, null, scopes);\n                callback(token, null);\n            }\n        });\n        this.nonce = \"token\" + this.generateNonce();\n        this.state = \"token\" + this.generateNonce();\n        if (!promptForConsent) {\n            var iframe = document.createElement('iframe');\n            iframe.style.display = \"none\";\n            iframe.id = \"tokenIFrame\";\n            iframe.src = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n                \"&scopes=\" + encodeURIComponent(scopes.join(\" \")) +\n                \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n                \"&version=\" + encodeURIComponent(this.version.toString()) +\n                \"&state=\" + encodeURIComponent(this.state) +\n                \"&nonce=\" + encodeURIComponent(this.nonce) +\n                \"&login_hint=\" + encodeURIComponent(this.idToken.PreferredUsername) +\n                \"&domain_hint=\" + encodeURIComponent(this.idToken.TenantId === \"9188040d-6c67-4c5b-b112-36a304b66dad\" ? \"consumers\" : \"organizations\") +\n                \"&op=token\";\n            document.body.appendChild(iframe);\n        }\n        else {\n            window.open(this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n                \"&scopes=\" + encodeURIComponent(scopes.join(\" \")) +\n                \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n                \"&version=\" + encodeURIComponent(this.version.toString()) +\n                \"&state=\" + encodeURIComponent(this.state) +\n                \"&nonce=\" + encodeURIComponent(this.nonce) +\n                \"&op=token\", \"_blank\");\n        }\n    };\n    Identity.prototype.loginAsync = function (loginSettings) {\n        var d = new promises_1.Deferred();\n        this.login(function (error) {\n            if (error) {\n                d.reject(error);\n            }\n            else {\n                d.resolve(null);\n            }\n        }, loginSettings);\n        return d.promise;\n    };\n    Identity.prototype.login = function (callback, loginSettings) {\n        this.loginCallback = callback;\n        if (!loginSettings)\n            loginSettings = {};\n        if (loginSettings.policy)\n            this.policy = loginSettings.policy;\n        if (loginSettings.scopes && this.version === OAuthVersion.v1) {\n            var e = new Error();\n            e.text = \"Scopes can only be used with OAuth v2.\";\n            callback(e);\n            return;\n        }\n        if (loginSettings.policy && !loginSettings.tenant) {\n            var e = new Error();\n            e.text = \"In order to use policy (AAD B2C) a tenant must be specified as well.\";\n            callback(e);\n            return;\n        }\n        this.state = \"login\" + this.generateNonce();\n        this.nonce = \"login\" + this.generateNonce();\n        var loginURL = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n            \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n            \"&state=\" + encodeURIComponent(this.state) +\n            \"&nonce=\" + encodeURIComponent(this.nonce) +\n            \"&version=\" + encodeURIComponent(this.version.toString()) +\n            \"&op=login\" +\n            \"&p=\" + encodeURIComponent(this.policy);\n        if (loginSettings.tenant) {\n            loginURL += \"&tenant=\" + encodeURIComponent(loginSettings.tenant);\n        }\n        if (this.version === OAuthVersion.v2) {\n            if (!loginSettings.scopes)\n                loginSettings.scopes = [];\n            if (loginSettings.scopes.indexOf(\"profile\") < 0)\n                loginSettings.scopes.push(\"profile\");\n            if (loginSettings.scopes.indexOf(\"openid\") < 0)\n                loginSettings.scopes.push(\"openid\");\n            loginURL += \"&scopes=\" + encodeURIComponent(loginSettings.scopes.join(\" \"));\n        }\n        window.open(loginURL, \"_blank\");\n    };\n    Identity.prototype.loginNoWindowAsync = function (toUrl) {\n        var d = new promises_1.Deferred();\n        this.loginNoWindow(function (error) {\n            if (error) {\n                d.reject(error);\n            }\n            else {\n                d.resolve(null);\n            }\n        }, toUrl);\n        return d.promise;\n    };\n    Identity.prototype.loginNoWindow = function (callback, toUrl) {\n        this.loginCallback = callback;\n        this.state = \"clientId=\" + this.clientId + \"&\" + \"tokenProcessorUrl=\" + this.tokenProcessorUrl;\n        this.nonce = this.generateNonce();\n        var redirected = this.checkForIdentityRedirect();\n        if (!redirected) {\n            var redirectUri = (toUrl) ? toUrl : window.location.href.split(\"#\")[0];\n            var url = \"https://login.microsoftonline.com/common/oauth2/authorize?response_type=id_token\" +\n                \"&client_id=\" + encodeURIComponent(this.clientId) +\n                \"&redirect_uri=\" + encodeURIComponent(redirectUri) +\n                \"&state=\" + encodeURIComponent(this.state) +\n                \"&nonce=\" + encodeURIComponent(this.nonce);\n            window.location.href = url;\n        }\n    };\n    Identity.prototype.logOut = function () {\n        this.tokenCache.clear();\n        var url = \"https://login.microsoftonline.com/common/oauth2/logout?post_logout_redirect_uri=\" + encodeURI(window.location.href);\n        window.location.href = url;\n    };\n    Identity.prototype.base64Decode = function (encodedString) {\n        var e = {}, i, b = 0, c, x, l = 0, a, r = '', w = String.fromCharCode, L = encodedString.length;\n        var A = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n        for (i = 0; i < 64; i++) {\n            e[A.charAt(i)] = i;\n        }\n        for (x = 0; x < L; x++) {\n            c = e[encodedString.charAt(x)];\n            b = (b << 6) + c;\n            l += 6;\n            while (l >= 8) {\n                ((a = (b >>> (l -= 8)) & 0xff) || (x < (L - 2))) && (r += w(a));\n            }\n        }\n        return r;\n    };\n    Identity.prototype.generateNonce = function () {\n        var text = \"\";\n        var chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n        for (var i = 0; i < 32; i++) {\n            text += chars.charAt(Math.floor(Math.random() * chars.length));\n        }\n        return text;\n    };\n    return Identity;\n}());\nexports.Identity = Identity;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/identity.ts\n ** module id = 3\n ** module chunks = 0\n **/"],"sourceRoot":""}